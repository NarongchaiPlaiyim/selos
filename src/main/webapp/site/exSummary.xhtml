<!DOCTYPE html>
<html>
<f:view xmlns="http://www.w3.org/1999/xhtml"
        xmlns:f="http://java.sun.com/jsf/core"
        xmlns:h="http://java.sun.com/jsf/html"
        xmlns:ui="http://java.sun.com/jsf/facelets"
        xmlns:p="http://primefaces.org/ui">

<h:head>
    <title>SE-LOS : Executive Summary</title>
    <h:outputStylesheet name="css/style.css" />
    <h:outputScript library="js" name="custom.js" />
    <style>
        .ui-datatable td,.ui-datatable th,.ui-datatable span {
            white-space: normal!important;
        }
    </style>
</h:head>

<h:body>
    <f:event type="preRenderView" listener="#{executiveSummary.preRender()}" />
    <p:panel id="pnl_maincontainer" style="border:0; margin:0; padding: 0;">
        <h:form id="frmMain">
            <div id="main_container">
                <!-- Start Header Logo -->
                <ui:include src="include/header_logo.xhtml"/>
                <!-- End Header Logo -->
                <!-- Start Header Detail -->
                <ui:include src="include/header_detail.xhtml"/>
                <!-- End Header Detail -->
                <!-- Start Menu -->
                <ui:include src="include/menubar.xhtml"/>
                <!-- End Menu -->
                <div id="content_container">
                <div id="content_name">#{msg.get('app.executiveSummary.header')}</div>
                <div id="content">
                <div id="content_info">
                    <div id="content_trackchange" title="Click to view Track Change">[ View Track Change ]</div>
                    <div id="content_lastupdate">Last update by
                        <h:outputText id="lastupdateName" value="#{executiveSummary.exSummaryView.modifyBy.userName}"/>,
                        <h:outputText id="lastupdateTime" value="#{executiveSummary.exSummaryView.modifyDate}"/></div>
                </div>
                <div id="content_form">
                <!-- start content -->
                <table class="content_table_form">

                <!-- Borrower -->
                <tr>
                    <td>
                        <!-- start content -->
                        <table class="content_table_form" style="width: 100%">
                            <tr>
                                <td colspan="2" style="text-align: left" class="title">
                                    <h:outputText value="#{msg.get('app.exSummary.borrower.table.caption')}"/>
                                </td>
                            </tr>
                            <tr>
                                <td colspan="2">
                                    <p:dataTable id="borrower" var="item" value="#{executiveSummary.exSummaryView.borrowerListView}"
                                                 paginator="false" rowKey="#{item}" rowIndexVar="rowIndex">
                                        <p:columnGroup type="header">
                                            <p:row>
                                                <p:column rowspan="2" width="20"
                                                          style="min-width: 20px; max-width: 20px; width: 20px;"/>
                                                <p:column rowspan="2" width="200"
                                                          style="min-width: 200px; max-width: 200px; width: 200px;">
                                                    <f:facet name="header">#{msg.get('app.exSummary.borrower.table.label.cusName')}</f:facet>
                                                </p:column>
                                                <p:column rowspan="1" colspan="2" width="260"
                                                          style="min-width: 260px; max-width: 260px; width: 260px;">
                                                    <f:facet name="header">#{msg.get('app.exSummary.borrower.table.label.id')}</f:facet>
                                                </p:column>
                                                <p:column rowspan="1" colspan="2" width="140"
                                                          style="min-width: 150px; max-width: 150px; width: 150px;">
                                                    <f:facet name="header">#{msg.get('app.exSummary.borrower.table.label.relation')}</f:facet>
                                                </p:column>
                                                <p:column rowspan="1" colspan="2" width="400"
                                                          style="min-width: 400px; max-width: 400px; width: 400px;">
                                                    <f:facet name="header">#{msg.get('app.exSummary.borrower.table.label.reference')}</f:facet>
                                                </p:column>
                                                <p:column rowspan="2" width="70"
                                                          style="min-width: 70px; max-width: 70px; width: 70px;">
                                                    <f:facet name="header">#{msg.get('app.exSummary.borrower.table.label.percentShare')}</f:facet>
                                                </p:column>
                                                <p:column rowspan="2" width="30"
                                                          style="min-width: 30px; max-width: 30px; width: 30px;">
                                                    <f:facet name="header">#{msg.get('app.exSummary.borrower.table.label.age')}</f:facet>
                                                </p:column>
                                                <p:column rowspan="2" width="30"
                                                          style="min-width: 30px; max-width: 30px; width: 30px;">
                                                    <f:facet name="header">#{msg.get('app.exSummary.borrower.table.label.kyc')}</f:facet>
                                                </p:column>
                                                <p:column rowspan="2" width="100"
                                                          style="min-width: 100px; max-width: 100px; width: 100px;">
                                                    <f:facet name="header">#{msg.get('app.exSummary.borrower.table.label.csi')}</f:facet>
                                                </p:column>
                                                <p:column rowspan="2" width="50"
                                                          style="min-width: 50px; max-width: 50px; width: 50px;">
                                                    <f:facet name="header">#{msg.get('app.exSummary.borrower.table.label.worthiness')}</f:facet>
                                                </p:column>
                                            </p:row>
                                            <p:row>
                                                <p:column colspan="1" width="130"
                                                          style="min-width: 130px; max-width: 130px; width: 130px;">
                                                    <f:facet name="header">#{msg.get('app.exSummary.borrower.table.label.personalID')}</f:facet>
                                                </p:column>
                                                <p:column colspan="1" width="130"
                                                          style="min-width: 130px; max-width: 130px; width: 130px;">
                                                    <f:facet name="header">#{msg.get('app.exSummary.borrower.table.label.tmbCusID')}</f:facet>
                                                </p:column>
                                                <p:column colspan="1" width="110"
                                                          style="min-width: 110px; max-width: 110px; width: 110px;">
                                                    <f:facet name="header">#{msg.get('app.exSummary.borrower.table.label.relationshipType')}</f:facet>
                                                </p:column>
                                                <p:column colspan="1" width="40"
                                                          style="min-width: 40px; max-width: 40px; width: 40px;">
                                                    <f:facet name="header">#{msg.get('app.exSummary.borrower.table.label.collateralOwnerFlag')}</f:facet>
                                                </p:column>
                                                <p:column colspan="1" width="200"
                                                          style="min-width: 200px; max-width: 200px; width: 200px;">
                                                    <f:facet name="header">#{msg.get('app.exSummary.borrower.table.label.referenceIndvLevel')}</f:facet>
                                                </p:column>
                                                <p:column colspan="1" width="200"
                                                          style="min-width: 200px; max-width: 200px; width: 200px;">
                                                    <f:facet name="header">#{msg.get('app.exSummary.borrower.table.label.referenceJurisLevel')}</f:facet>
                                                </p:column>
                                            </p:row>
                                        </p:columnGroup>

                                        <p:column styleClass="center">
                                            <h:outputText value="#{rowIndex+1}"
                                                          style="min-width: 20px; max-width: 20px; width: 20px;"/>
                                        </p:column>

                                        <p:column styleClass="left">
                                            <h:outputText value="#{item.titleTh.titleTh}#{item.firstNameTh} #{item.lastNameTh}"
                                                          style="min-width: 200px; max-width: 200px; width: 200px;"/>
                                        </p:column>

                                        <p:column styleClass="center">
                                            <h:outputText value="#{item.citizenId}"
                                                          style="min-width: 130px; max-width: 130px; width: 130px;"
                                                          rendered="#{item.customerEntity.id == 1}"/>
                                            <h:outputText value="#{item.registrationId}"
                                                          style="min-width: 130px; max-width: 130px; width: 130px;"
                                                          rendered="#{item.customerEntity.id == 2}"/>
                                        </p:column>

                                        <p:column styleClass="center">
                                            <h:outputText value="#{item.tmbCustomerId}"
                                                          style="min-width: 130px; max-width: 130px; width: 130px;"/>
                                        </p:column>

                                        <p:column styleClass="center">
                                            <h:outputText value="#{item.relation.description}"
                                                          style="min-width: 110px; max-width: 110px; width: 110px;"/>
                                        </p:column>

                                        <p:column styleClass="center">
                                            <h:outputText value="#{item.collateralOwner == 2 ? 'Y' : 'N'}"
                                                          style="min-width: 40px; max-width: 40px; width: 40px;"/>
                                        </p:column>

                                        <p:column styleClass="center">
                                            <h:outputText value="#{item.indLv}"
                                                          style="min-width: 200px; max-width: 200px; width: 200px;"/>
                                        </p:column>

                                        <p:column styleClass="center">
                                            <h:outputText value="#{item.jurLv}"
                                                          style="min-width: 200px; max-width: 200px; width: 200px;"/>
                                        </p:column>

                                        <p:column styleClass="center">
                                            <h:outputText value="#{item.percentShare}"
                                                          style="min-width: 70px; max-width: 70px; width: 70px;"/>
                                        </p:column>

                                        <p:column styleClass="center">
                                            <h:outputText value="#{item.age}"
                                                          style="min-width: 30px; max-width: 30px; width: 30px;"/>
                                        </p:column>

                                        <p:column styleClass="center">
                                            <h:outputText value="#{item.kycLevel.kycLevel}"
                                                          style="min-width: 30px; max-width: 30px; width: 30px;"/>
                                        </p:column>

                                        <p:column styleClass="center" style="min-width: 100px; max-width: 100px; width: 100px; white-space: normal!important;">
                                            <ui:repeat value="#{item.customerCSIList}" var="customerCSI">
                                                <h:outputText value="#{customerCSI.warningCode.code}"/><p:spacer width="5"/>
                                            </ui:repeat>
                                        </p:column>

                                        <p:column styleClass="center">
                                            <h:outputText value="#{item.worthiness == 3 ? 'Pass' : item.worthiness == 4 ? 'Fail' : item.worthiness == 5 ? 'N/A' : '-'}"
                                                          style="min-width: 50px; max-width: 50px; width: 50px;"/>
                                        </p:column>
                                    </p:dataTable>
                                </td>
                            </tr>
                        </table>
                        <!-- end content -->
                    </td>
                </tr>

                <!-- Biz Name -->
                <tr>
                    <td style="padding-left: 5px; padding-top: 8px;">
                        <table class="table_content" style="width: 100%;">
                            <tr>
                                <td style="width: 300px;text-align: left" class="title">
                                    <h:outputText value="#{msg.get('app.exSummary.business.location.label.name')}"/>
                                </td>
                                <td style="text-align: left">
                                    <h:outputText value="#{executiveSummary.exSummaryView.businessLocationName}"/>
                                </td>
                            </tr>
                            <tr>
                                <td style="text-align: left" class="title">
                                    <h:outputText value="#{msg.get('app.exSummary.business.location.label.address')}"/>
                                </td>
                                <td style="text-align: left">
                                    <h:outputText value="#{executiveSummary.exSummaryView.businessLocationAddress}"/>
                                </td>
                            </tr>
                            <tr>
                                <td style="text-align: left" class="title">
                                    <h:outputText value="#{msg.get('app.exSummary.business.location.label.addressEng')}"/>
                                </td>
                                <td style="text-align: left">
                                    <h:outputText value="#{executiveSummary.exSummaryView.businessLocationAddressEN}"/>
                                </td>
                            </tr>
                            <tr>
                                <td style="text-align: left" class="title">
                                    <h:outputText value="#{msg.get('app.exSummary.business.location.label.owner')}"/>
                                </td>
                                <td style="text-align: left">
                                    <h:outputText value="#{executiveSummary.exSummaryView.owner}"/>
                                </td>
                            </tr>
                        </table>
                    </td>
                </tr>

                <!-- Trade Finance -->
                <tr>
                    <td>
                        <!-- start content -->
                        <table class="content_table_form" style="width: 100%;">
                            <tr>
                                <td colspan="2" style="text-align: left" class="title">
                                    <h:outputText value="#{msg.get('app.exSummary.trade.table.caption')}"/>
                                </td>
                            </tr>
                            <tr>
                                <td colspan="2">
                                    <p:dataTable id="tradeTable" var="itemTrade"
                                                 value="#{executiveSummary.exSummaryView.tradeFinance}" style="width: 100%">
                                        <p:columnGroup type="header">
                                            <p:row>
                                                <p:column style="width:200px;"
                                                          headerText="#{msg.get('app.exSummary.trade.table.label.contactName')}"/>
                                                <p:column style="width:200px;"
                                                          headerText="#{msg.get('app.exSummary.trade.table.label.contactPhoneNo')}"/>
                                                <p:column style="width:500px;"
                                                          headerText="#{msg.get('app.exSummary.trade.table.label.interService')}"/>
                                                <p:column style="width:500px;"
                                                          headerText="#{msg.get('app.exSummary.trade.table.label.address')}"/>
                                                <p:column style="width:200px;"
                                                          headerText="#{msg.get('app.exSummary.trade.table.label.importEmail')}"/>
                                                <p:column style="width:200px;"
                                                          headerText="#{msg.get('app.exSummary.trade.table.label.exportEmail')}"/>
                                                <p:column style="width:200px;"
                                                          headerText="#{msg.get('app.exSummary.trade.table.label.depositBranchCode')}"/>
                                                <p:column style="width:200px;"
                                                          headerText="#{msg.get('app.exSummary.trade.table.label.ownerBranchCode')}"/>
                                            </p:row>
                                        </p:columnGroup>

                                        <p:column styleClass="center">
                                            <h:outputText value="#{itemTrade.contactName}"/>
                                        </p:column>

                                        <p:column styleClass="center">
                                            <h:outputText value="#{itemTrade.contactPhoneNo}"/>
                                        </p:column>

                                        <p:column styleClass="center">
                                            <h:outputText value="#{itemTrade.interService}"/>
                                        </p:column>

                                        <p:column styleClass="center">
                                            <h:outputText value="#{itemTrade.currentAddress}"/>
                                        </p:column>

                                        <p:column styleClass="center">
                                            <h:outputText value="#{itemTrade.importMail}"/>
                                        </p:column>

                                        <p:column styleClass="center">
                                            <h:outputText value="#{itemTrade.exportMail}"/>
                                        </p:column>

                                        <p:column styleClass="center">
                                            <h:outputText value="#{itemTrade.depositBranchCode}"/>
                                        </p:column>

                                        <p:column styleClass="center">
                                            <h:outputText value="#{itemTrade.ownerBranchCode}"/>
                                        </p:column>
                                    </p:dataTable>
                                </td>
                            </tr>
                        </table>
                        <!-- end content -->
                    </td>
                </tr>

                <tr>
                    <td colspan="6" style="padding-top: 15px;">
                        <div class="separate"><!-- --></div>
                    </td>
                </tr>

                <!-- Borrower Characteristic -->
                <tr>
                    <td>
                        <!-- start content -->
                        <table class="content_table_form" style="width: 100%;">
                            <tr>
                                <td colspan="2" style="text-align: left" class="title">
                                    <h:outputText value="#{msg.get('app.exSummary.characteristic.tb.caption')}"/>
                                </td>
                            </tr>
                            <tr>
                                <td colspan="2">
                                    <p:dataTable id="borrowerCharacteristic" var="itemBorCha"
                                                 value="#{executiveSummary.exSummaryView.exSumCharacteristicView}" style="width: 100%">
                                        <p:columnGroup type="header">
                                            <p:row>
                                                <p:column rowspan="2" style="width:200px;"
                                                          headerText="#{msg.get('app.exSummary.characteristic.tb.label.creditCusType')}"/>
                                                <p:column rowspan="2" style="width:200px;"
                                                          headerText="#{msg.get('app.exSummary.characteristic.tb.label.currentDBR')}"/>
                                                <p:column rowspan="2" style="width:200px;"
                                                          headerText="#{msg.get('app.exSummary.characteristic.tb.label.finalDBR')}"/>
                                                <p:column rowspan="2" style="width:200px;"
                                                          headerText="#{msg.get('app.exSummary.characteristic.tb.label.income')}"/>
                                                <p:column rowspan="2" style="width:200px;"
                                                          headerText="#{msg.get('app.exSummary.characteristic.tb.label.recommendedWCNeed')}"/>
                                                <p:column rowspan="2" style="width:150px;"
                                                          headerText="#{msg.get('app.exSummary.characteristic.tb.label.actualWC')}"/>
                                                <p:column rowspan="2" style="width:150px;"
                                                          headerText="#{msg.get('app.exSummary.characteristic.tb.label.startBusinessDate')}"/>
                                                <p:column rowspan="2" style="width:150px;"
                                                          headerText="#{msg.get('app.exSummary.characteristic.tb.label.yearInBusiness')}"/>
                                                <p:column colspan="2" style="width:150px;"
                                                          headerText="#{msg.get('app.exSummary.characteristic.tb.label.salePerYear')}"/>
                                                <p:column colspan="2" style="width:150px;"
                                                          headerText="#{msg.get('app.exSummary.characteristic.tb.label.groupSale')}"/>
                                                <p:column colspan="2" style="width:150px;"
                                                          headerText="#{msg.get('app.exSummary.characteristic.tb.label.groupExposure')}"/>
                                            </p:row>
                                            <p:row>
                                                <p:column style="width:100px;"
                                                          headerText="#{msg.get('app.exSummary.characteristic.tb.label.salePerYearBDM')}"/>
                                                <p:column style="width:100px;"
                                                          headerText="#{msg.get('app.exSummary.characteristic.tb.label.salePerYearUW')}"/>
                                                <p:column style="width:100px;"
                                                          headerText="#{msg.get('app.exSummary.characteristic.tb.label.groupSaleBDM')}"/>
                                                <p:column style="width:100px;"
                                                          headerText="#{msg.get('app.exSummary.characteristic.tb.label.groupSaleUW')}"/>
                                                <p:column style="width:100px;"
                                                          headerText="#{msg.get('app.exSummary.characteristic.tb.label.groupExposureBDM')}"/>
                                                <p:column style="width:100px;"
                                                          headerText="#{msg.get('app.exSummary.characteristic.tb.label.groupExposureUW')}"/>
                                            </p:row>
                                        </p:columnGroup>

                                        <p:column styleClass="center">
                                            <h:outputText value="#{itemBorCha.customer}"/>
                                        </p:column>

                                        <p:column styleClass="center">
                                            <h:outputText value="#{itemBorCha.currentDBR}"/>
                                        </p:column>

                                        <p:column styleClass="center">
                                            <h:outputText value="#{itemBorCha.finalDBR}"/>
                                        </p:column>

                                        <p:column styleClass="center">
                                            <h:outputText value="#{itemBorCha.income}">
                                                <f:convertNumber pattern="#,##0" minFractionDigits="2" maxFractionDigits="2"/>
                                            </h:outputText>
                                        </p:column>

                                        <p:column styleClass="center">
                                            <h:outputText value="#{itemBorCha.recommendedWCNeed}">
                                                <f:convertNumber pattern="#,##0" minFractionDigits="2" maxFractionDigits="2"/>
                                            </h:outputText>
                                        </p:column>

                                        <p:column styleClass="center">
                                            <h:outputText value="#{itemBorCha.actualWC}">
                                                <f:convertNumber pattern="#,##0" minFractionDigits="2" maxFractionDigits="2"/>
                                            </h:outputText>
                                        </p:column>

                                        <p:column styleClass="center">
                                            <h:outputText value="#{itemBorCha.startBusinessDate}">
                                                <f:convertDateTime pattern="dd/MM/yyyy" locale="th_TH"/>
                                            </h:outputText>
                                        </p:column>

                                        <p:column styleClass="center">
                                            <h:outputText value="#{itemBorCha.yearInBusiness}"/>
                                        </p:column>

                                        <p:column styleClass="center">
                                            <h:outputText value="#{itemBorCha.salePerYearBDM != null ? itemBorCha.salePerYearBDM : '-'}">
                                                <f:convertNumber pattern="#,##0" minFractionDigits="2" maxFractionDigits="2"/>
                                            </h:outputText>
                                        </p:column>

                                        <p:column styleClass="center">
                                            <h:outputText value="#{itemBorCha.salePerYearUW != null ? itemBorCha.salePerYearUW : '-'}">
                                                <f:convertNumber pattern="#,##0" minFractionDigits="2" maxFractionDigits="2"/>
                                            </h:outputText>
                                        </p:column>

                                        <p:column styleClass="center">
                                            <h:outputText value="#{itemBorCha.groupSaleBDM != null ? itemBorCha.groupSaleBDM : '-'}">
                                                <f:convertNumber pattern="#,##0" minFractionDigits="2" maxFractionDigits="2"/>
                                            </h:outputText>
                                        </p:column>

                                        <p:column styleClass="center">
                                            <h:outputText value="#{itemBorCha.groupSaleUW != null ? itemBorCha.groupSaleUW : '-'}">
                                                <f:convertNumber pattern="#,##0" minFractionDigits="2" maxFractionDigits="2"/>
                                            </h:outputText>
                                        </p:column>

                                        <p:column styleClass="center">
                                            <h:outputText value="#{itemBorCha.groupExposureBDM != null ? itemBorCha.groupExposureBDM : '-'}">
                                                <f:convertNumber pattern="#,##0" minFractionDigits="2" maxFractionDigits="2"/>
                                            </h:outputText>
                                        </p:column>

                                        <p:column styleClass="center">
                                            <h:outputText value="#{itemBorCha.groupExposureUW != null ? itemBorCha.groupExposureUW : '-'}">
                                                <f:convertNumber pattern="#,##0" minFractionDigits="2" maxFractionDigits="2"/>
                                            </h:outputText>
                                        </p:column>
                                    </p:dataTable>
                                </td>
                            </tr>
                        </table>
                        <!-- end content -->
                    </td>
                </tr>

                <!-- Borrower Characteristic 2 -->
                <tr>
                    <td style="padding-top: 20px;">
                        <!-- start content -->
                        <table class="content_table_form" style="width: 100%;">
                            <tr>
                                <td colspan="2">
                                    <p:dataTable id="businessInfoSum" var="itemBusinessInfo"
                                                 value="#{executiveSummary.exSummaryView.exSumBusinessInfoView}" style="width: 100%">
                                        <p:columnGroup type="header">
                                            <p:row>
                                                <p:column rowspan="2" style="width:200px;"
                                                          headerText="#{msg.get('app.exSummary.businessInfoSum.tb.label.netFixAsset')}"/>
                                                <p:column rowspan="2" style="width:200px;"
                                                          headerText="#{msg.get('app.exSummary.businessInfoSum.tb.label.noOfEmployee')}"/>
                                                <p:column rowspan="2" style="width:200px;"
                                                          headerText="#{msg.get('app.exSummary.businessInfoSum.tb.label.bizLocation')}"/>
                                                <p:column rowspan="2" style="width:200px;"
                                                          headerText="#{msg.get('app.exSummary.businessInfoSum.tb.label.bizType')}"/>
                                                <p:column rowspan="2" style="width:200px;"
                                                          headerText="#{msg.get('app.exSummary.businessInfoSum.tb.label.bizGroup')}"/>
                                                <p:column rowspan="2" style="width:150px;"
                                                          headerText="#{msg.get('app.exSummary.businessInfoSum.tb.label.bizCode')}"/>
                                                <p:column rowspan="2" style="width:150px;"
                                                          headerText="#{msg.get('app.exSummary.businessInfoSum.tb.label.bizDesc')}"/>
                                                <p:column rowspan="2" style="width:150px;"
                                                          headerText="#{msg.get('app.exSummary.businessInfoSum.tb.label.qualitativeClass')}"/>
                                                <p:column rowspan="2" style="width:150px;"
                                                          headerText="#{msg.get('app.exSummary.businessInfoSum.tb.label.bizSize')}"/>
                                                <p:column colspan="2" style="width:150px;"
                                                          headerText="#{msg.get('app.exSummary.businessInfoSum.tb.label.incomeFactorPercent')}"/>
                                                <p:column rowspan="2" style="width:150px;"
                                                          headerText="#{msg.get('app.exSummary.businessInfoSum.tb.label.AR')}"/>
                                                <p:column rowspan="2" style="width:150px;"
                                                          headerText="#{msg.get('app.exSummary.businessInfoSum.tb.label.AP')}"/>
                                                <p:column rowspan="2" style="width:150px;"
                                                          headerText="#{msg.get('app.exSummary.businessInfoSum.tb.label.INV')}"/>
                                            </p:row>
                                            <p:row>
                                                <p:column style="width:100px;"
                                                          headerText="#{msg.get('app.exSummary.businessInfoSum.tb.label.incomeFactorPercentBDM')}"/>
                                                <p:column style="width:100px;"
                                                          headerText="#{msg.get('app.exSummary.businessInfoSum.tb.label.incomeFactorPercentUW')}"/>
                                            </p:row>
                                        </p:columnGroup>

                                        <p:column styleClass="center">
                                            <h:outputText value="#{itemBusinessInfo.netFixAsset}">
                                                <f:convertNumber pattern="#,##0" minFractionDigits="2" maxFractionDigits="2"/>
                                            </h:outputText>
                                        </p:column>

                                        <p:column styleClass="center">
                                            <h:outputText value="#{itemBusinessInfo.noOfEmployee}"/>
                                        </p:column>

                                        <p:column styleClass="center">
                                            <h:outputText value="#{itemBusinessInfo.bizProvince}"/>
                                        </p:column>

                                        <p:column styleClass="center">
                                            <h:outputText value="#{itemBusinessInfo.bizType}"/>
                                        </p:column>

                                        <p:column styleClass="center">
                                            <h:outputText value="#{itemBusinessInfo.bizGroup}"/>
                                        </p:column>

                                        <p:column styleClass="center">
                                            <h:outputText value="#{itemBusinessInfo.bizCode}"/>
                                        </p:column>

                                        <p:column styleClass="center">
                                            <h:outputText value="#{itemBusinessInfo.bizDesc}"/>
                                        </p:column>

                                        <p:column styleClass="center">
                                            <h:outputText value="#{itemBusinessInfo.qualitativeClass}"/>
                                        </p:column>

                                        <p:column styleClass="center">
                                            <h:outputText value="#{itemBusinessInfo.bizSize}">
                                                <f:convertNumber pattern="#,##0" minFractionDigits="2" maxFractionDigits="2"/>
                                            </h:outputText>
                                        </p:column>

                                        <p:column styleClass="center">
                                            <h:outputText value="#{itemBusinessInfo.BDM}">
                                                <f:convertNumber pattern="#,##0" minFractionDigits="2" maxFractionDigits="2"/>
                                            </h:outputText>
                                        </p:column>

                                        <p:column styleClass="center">
                                            <h:outputText value="#{itemBusinessInfo.UW}">
                                                <f:convertNumber pattern="#,##0" minFractionDigits="2" maxFractionDigits="2"/>
                                            </h:outputText>
                                        </p:column>

                                        <p:column styleClass="center">
                                            <h:outputText value="#{itemBusinessInfo.AR}">
                                                <f:convertNumber pattern="#,##0" minFractionDigits="2" maxFractionDigits="2"/>
                                            </h:outputText>
                                        </p:column>

                                        <p:column styleClass="center">
                                            <h:outputText value="#{itemBusinessInfo.AP}">
                                                <f:convertNumber pattern="#,##0" minFractionDigits="2" maxFractionDigits="2"/>
                                            </h:outputText>
                                        </p:column>

                                        <p:column styleClass="center">
                                            <h:outputText value="#{itemBusinessInfo.INV}">
                                                <f:convertNumber pattern="#,##0" minFractionDigits="2" maxFractionDigits="2"/>
                                            </h:outputText>
                                        </p:column>
                                    </p:dataTable>
                                </td>
                            </tr>

                            <tr>
                                <td style="padding-left: 5px; padding-top: 8px;">
                                    <table style="width: 100%;">
                                        <tr>
                                            <td style="width: 200px; min-width: 200px; max-width: 200px; text-align: left" class="title">
                                                <h:outputText value="#{msg.get('app.exSummary.businessInfoSum.label.businessOperationActivity')}"/>
                                            </td>
                                            <td style="text-align: left">
                                                <h:outputText value="#{executiveSummary.exSummaryView.businessOperationActivity}"/>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td style="text-align: left" class="title">
                                                <h:outputText value="#{msg.get('app.exSummary.businessInfoSum.label.businessPermission')}"/>
                                            </td>
                                            <td style="text-align: left">
                                                <h:outputText value="#{executiveSummary.exSummaryView.businessPermission}"/>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td style="text-align: left" class="title">
                                                <h:outputText value="#{msg.get('app.exSummary.businessInfoSum.label.expiryDate')}"/>
                                            </td>
                                            <td style="text-align: left">
                                                <h:outputText value="#{executiveSummary.exSummaryView.expiryDate != null ? executiveSummary.exSummaryView.expiryDate : '-'}">
                                                    <f:convertDateTime pattern="dd/MM/yyyy" locale="th_TH"/>
                                                </h:outputText>
                                            </td>
                                        </tr>
                                    </table>
                                </td>
                            </tr>
                        </table>
                        <!-- end content -->
                    </td>
                </tr>

                <tr>
                    <td colspan="2" style="padding-top: 10px;">
                        <div class="separate"><!-- --></div>
                    </td>
                </tr>

                <!-- NCB Record -->
                <tr>
                    <td>
                        <!-- start content -->
                        <table class="content_table_form" style="width: 100%;">
                            <tr>
                                <td colspan="2" style="text-align: left" class="title">
                                    <h:outputText value="#{msg.get('app.exSummary.ncb.tb.caption')}"/>
                                </td>
                            </tr>
                            <tr>
                                <td colspan="2">
                                    <p:dataTable id="ncbRecord" value="#{executiveSummary.exSummaryView.ncbInfoListView}"
                                                 var="ncbItem" style="width: 100%">
                                        <p:columnGroup type="header">
                                            <p:row>
                                                <p:column style="width:200px;"
                                                          headerText="#{msg.get('app.exSummary.ncb.tb.label.cusName')}"/>
                                                <p:column style="width:200px;"
                                                          headerText="#{msg.get('app.exSummary.ncb.tb.label.noOfNCBCheckIn6months')}"/>
                                                <p:column style="width:500px;"
                                                          headerText="#{msg.get('app.exSummary.ncb.tb.label.typeOfCurrentPayment')}"/>
                                                <p:column style="width:500px;"
                                                          headerText="#{msg.get('app.exSummary.ncb.tb.label.typeOfHistoryPayment')}"/>
                                                <p:column style="width:200px;"
                                                          headerText="#{msg.get('app.exSummary.ncb.tb.label.NPLFlag')}"/>
                                                <p:column style="width:200px;"
                                                          headerText="#{msg.get('app.exSummary.ncb.tb.label.TDRFlag')}"/>
                                                <p:column style="width:200px;"
                                                          headerText="#{msg.get('app.exSummary.ncb.tb.label.TDRPaymentCondition')}"/>
                                                <p:column style="width:200px;"
                                                          headerText="#{msg.get('app.exSummary.ncb.tb.label.paymentClass')}"/>
                                            </p:row>
                                        </p:columnGroup>

                                        <p:column styleClass="center">
                                            <h:outputText value="#{ncbItem.ncbCusName}"/>
                                        </p:column>

                                        <p:column styleClass="center">
                                            <h:outputText value="#{ncbItem.checkIn6Month}"/>
                                        </p:column>

                                        <p:column styleClass="center">
                                            <h:outputText value="#{ncbItem.currentPaymentType}"/>
                                        </p:column>

                                        <p:column styleClass="center">
                                            <h:outputText value="#{ncbItem.historyPaymentType}"/>
                                        </p:column>

                                        <p:column styleClass="center">
                                            <h:outputText value="#{ncbItem.nplFlagText}"/>
                                        </p:column>

                                        <p:column styleClass="center">
                                            <h:outputText value="#{ncbItem.tdrFlagText}"/>
                                        </p:column>

                                        <p:column styleClass="center">
                                            <h:outputText value="#{ncbItem.tdrCondition.description}"/>
                                        </p:column>

                                        <p:column styleClass="center">
                                            <!--<h:outputText value="#{ncbItem.paymentClass}"/>-->
                                            <h:outputText value="BRMS Rule"/>
                                        </p:column>
                                    </p:dataTable>
                                </td>
                            </tr>
                        </table>
                        <!-- end content -->
                    </td>
                </tr>

                <tr>
                    <td colspan="2" style="padding-top: 10px;">
                        <div class="separate"><!-- --></div>
                    </td>
                </tr>

                <!-- Account Movement -->
                <tr>
                    <td>
                        <!-- start content -->
                        <table class="content_table_form" style="width: 100%;">
                            <tr>
                                <td colspan="2" style="text-align: left" class="title">
                                    <h:outputText value="#{msg.get('app.exSummary.tb.account.caption')}"/>
                                </td>
                            </tr>
                            <tr>
                                <td colspan="2">
                                    <p:dataTable id="accountMovement" value="#{executiveSummary.exSummaryView.exSumAccMovementViewList}"
                                                 var="accItem" style="width: 100%">
                                        <p:columnGroup type="header">
                                            <p:row>
                                                <p:column colspan="8" style="width:200px;"
                                                          headerText="#{msg.get('app.exSummary.tb.account.label.main.od')}"/>
                                                <p:column colspan="2" style="width:200px;"
                                                          headerText="#{msg.get('app.exSummary.tb.account.label.main.all')}"/>
                                            </p:row>
                                            <p:row>
                                                <p:column rowspan="2" style="width:200px;"
                                                          headerText="#{msg.get('app.exSummary.tb.account.label.odLimit')}"/>
                                                <p:column rowspan="2" style="width:200px;"
                                                          headerText="#{msg.get('app.exSummary.tb.account.label.utilization')}"/>
                                                <p:column rowspan="2" style="width:500px;"
                                                          headerText="#{msg.get('app.exSummary.tb.account.label.swing')}"/>
                                                <p:column rowspan="2" style="width:500px;"
                                                          headerText="#{msg.get('app.exSummary.tb.account.label.overLimitTimes')}"/>
                                                <p:column rowspan="2" style="width:200px;"
                                                          headerText="#{msg.get('app.exSummary.tb.account.label.overLimitDays')}"/>
                                                <p:column rowspan="2" style="width:200px;"
                                                          headerText="#{msg.get('app.exSummary.tb.account.label.chequeReturn')}"/>
                                                <p:column rowspan="2" style="width:200px;"
                                                          headerText="#{msg.get('app.exSummary.tb.account.label.cashFlow')}"/>
                                                <p:column rowspan="2" style="width:200px;"
                                                          headerText="#{msg.get('app.exSummary.tb.account.label.cashFlowLimit')}"/>
                                                <p:column colspan="2" style="width:200px;"
                                                          headerText="#{msg.get('app.exSummary.tb.account.label.main.trade.return')}"/>
                                            </p:row>
                                            <p:row>
                                                <p:column style="width:200px;"
                                                          headerText="#{msg.get('app.exSummary.tb.account.label.tradeChequeReturnAmount')}"/>
                                                <p:column style="width:200px;"
                                                          headerText="#{msg.get('app.exSummary.tb.account.label.tradeChequeReturnPercent')}"/>
                                            </p:row>

                                        </p:columnGroup>

                                        <p:column styleClass="center">
                                            <h:outputText value="#{accItem.odLimit}">
                                                <f:convertNumber pattern="#,##0" minFractionDigits="2" maxFractionDigits="2"/>
                                            </h:outputText>
                                        </p:column>

                                        <p:column styleClass="center">
                                            <h:outputText value="#{accItem.utilization}">
                                                <f:convertNumber pattern="#,##0" minFractionDigits="2" maxFractionDigits="2"/>
                                            </h:outputText>
                                        </p:column>

                                        <p:column styleClass="center">
                                            <h:outputText value="#{accItem.swing}">
                                                <f:convertNumber pattern="#,##0" minFractionDigits="2" maxFractionDigits="2"/>
                                            </h:outputText>
                                        </p:column>

                                        <p:column styleClass="center">
                                            <h:outputText value="#{accItem.overLimitTimes}">
                                                <f:convertNumber pattern="#,##0" minFractionDigits="0" maxFractionDigits="0"/>
                                            </h:outputText>
                                        </p:column>

                                        <p:column styleClass="center">
                                            <h:outputText value="#{accItem.overLimitDays}">
                                                <f:convertNumber pattern="#,##0" minFractionDigits="0" maxFractionDigits="0"/>
                                            </h:outputText>
                                        </p:column>

                                        <p:column styleClass="center">
                                            <h:outputText value="#{accItem.chequeReturn}">
                                                <f:convertNumber pattern="#,##0" minFractionDigits="0" maxFractionDigits="0"/>
                                            </h:outputText>
                                        </p:column>

                                        <p:column styleClass="center">
                                            <h:outputText value="#{accItem.cashFlow}">
                                                <f:convertNumber pattern="#,##0" minFractionDigits="2" maxFractionDigits="2"/>
                                            </h:outputText>
                                        </p:column>

                                        <p:column styleClass="center">
                                            <h:outputText value="#{accItem.cashFlowLimit}">
                                                <f:convertNumber pattern="#,##0" minFractionDigits="2" maxFractionDigits="2"/>
                                            </h:outputText>
                                        </p:column>

                                        <p:column styleClass="center">
                                            <h:outputText value="#{accItem.tradeChequeReturnAmount}">
                                                <f:convertNumber pattern="#,##0" minFractionDigits="2" maxFractionDigits="2"/>
                                            </h:outputText>
                                        </p:column>

                                        <p:column styleClass="center">
                                            <h:outputText value="#{accItem.tradeChequeReturnPercent}">
                                                <f:convertNumber pattern="#,##0" minFractionDigits="2" maxFractionDigits="2"/>
                                            </h:outputText>
                                        </p:column>
                                    </p:dataTable>
                                </td>
                            </tr>
                        </table>
                        <!-- end content -->
                    </td>
                </tr>

                <tr>
                    <td colspan="2" style="padding-top: 10px;">
                        <div class="separate"><!-- --></div>
                    </td>
                </tr>

                <!-- Collateral -->
                <tr>
                    <td>
                        <!-- start content -->
                        <table class="content_table_form" style="width: 100%;">
                            <tr>
                                <td colspan="2" style="text-align: left" class="title">
                                    <h:outputText value="#{msg.get('app.exSummary.tb.collateral.caption')}"/>
                                </td>
                            </tr>
                            <tr>
                                <td colspan="2">
                                    <p:dataTable id="collateral" value="#{executiveSummary.exSummaryView.exSumCollateralView}"
                                                 var="colItem" style="width: 100%">
                                        <p:columnGroup type="header">
                                            <p:row>
                                                <p:column colspan="3" style="width:990px;"
                                                          headerText="#{msg.get('app.exSummary.tb.collateral.label.proposeCollateralInfo')}"/>
                                                <p:column colspan="2" style="width:660px;"
                                                          headerText="#{msg.get('app.exSummary.tb.collateral.label.portion')}"/>
                                            </p:row>

                                            <p:row>
                                                <p:column style="width:330px;"
                                                          headerText="#{msg.get('app.exSummary.tb.collateral.label.cashCollateralValue')}"/>
                                                <p:column style="width:330px;"
                                                          headerText="#{msg.get('app.exSummary.tb.collateral.label.coreAssetValue')}"/>
                                                <p:column style="width:330px;"
                                                          headerText="#{msg.get('app.exSummary.tb.collateral.label.noneCoreAssetValue')}"/>
                                                <p:column style="width:330px;"
                                                          headerText="#{msg.get('app.exSummary.tb.collateral.label.limitApprove')}"/>
                                                <p:column style="width:330px;"
                                                          headerText="#{msg.get('app.exSummary.tb.collateral.label.percentLTV')}"/>
                                            </p:row>

                                        </p:columnGroup>

                                        <p:column styleClass="center">
                                            <h:outputText value="#{colItem.cashCollateralValue}">
                                                <f:convertNumber pattern="#,##0" minFractionDigits="2" maxFractionDigits="2"/>
                                            </h:outputText>
                                        </p:column>

                                        <p:column styleClass="center">
                                            <h:outputText value="#{colItem.coreAssetValue}">
                                                <f:convertNumber pattern="#,##0" minFractionDigits="2" maxFractionDigits="2"/>
                                            </h:outputText>
                                        </p:column>

                                        <p:column styleClass="center">
                                            <h:outputText value="#{colItem.noneCoreAssetValue}">
                                                <f:convertNumber pattern="#,##0" minFractionDigits="2" maxFractionDigits="2"/>
                                            </h:outputText>
                                        </p:column>

                                        <p:column styleClass="center">
                                            <h:outputText value="#{colItem.limitApprove}">
                                                <f:convertNumber pattern="#,##0" minFractionDigits="2" maxFractionDigits="2"/>
                                            </h:outputText>
                                        </p:column>

                                        <p:column styleClass="center">
                                            <h:outputText value="#{colItem.percentLTV}">
                                                <f:convertNumber pattern="#,##0" minFractionDigits="2" maxFractionDigits="2"/>
                                            </h:outputText>
                                        </p:column>
                                    </p:dataTable>
                                </td>
                            </tr>
                        </table>
                        <!-- end content -->
                    </td>
                </tr>

                <tr>
                    <td colspan="2" style="padding-top: 10px;">
                        <div class="separate"><!-- --></div>
                    </td>
                </tr>

                <!-- Credit Risk Information -->
                <tr>
                    <td>
                        <!-- start content -->
                        <table class="content_table_form" style="width: 100%;">
                            <tr>
                                <td colspan="2" style="text-align: left" class="title">
                                    <h:outputText value="#{msg.get('app.exSummary.tb.creditRiskInfo.caption')}"/>
                                </td>
                            </tr>
                            <tr>
                                <td colspan="2">
                                    <p:dataTable id="creditRiskInfo" value="#{executiveSummary.exSummaryView.exSumCreditRiskInfoView}"
                                                 var="creditRiskInfo" style="width: 100%">
                                        <p:columnGroup type="header">
                                            <p:row>
                                                <p:column style="width:200px;"
                                                          headerText="#{msg.get('app.exSummary.tb.creditRiskInfo.label.riskCusType')}"/>
                                                <p:column style="width:200px;"
                                                          headerText="#{msg.get('app.exSummary.tb.creditRiskInfo.label.BOTClass')}"/>
                                                <p:column style="width:500px;"
                                                          headerText="#{msg.get('app.exSummary.tb.creditRiskInfo.label.reason')}"/>
                                                <p:column style="width:500px;"
                                                          headerText="#{msg.get('app.exSummary.tb.creditRiskInfo.label.lastReviewDate')}"/>
                                                <p:column style="width:200px;"
                                                          headerText="#{msg.get('app.exSummary.tb.creditRiskInfo.label.nextReviewDate')}"/>
                                                <p:column style="width:200px;"
                                                          headerText="#{msg.get('app.exSummary.tb.creditRiskInfo.label.extendedReviewDate')}"/>
                                                <p:column style="width:200px;"
                                                          headerText="#{msg.get('app.exSummary.tb.creditRiskInfo.label.indirectCountryName')}"/>
                                                <p:column style="width:200px;"
                                                          headerText="#{msg.get('app.exSummary.tb.creditRiskInfo.label.percentExport')}"/>
                                            </p:row>

                                        </p:columnGroup>

                                        <p:column styleClass="center">
                                            <h:outputText value="#{creditRiskInfo.riskCusType}"/>
                                        </p:column>

                                        <p:column styleClass="center">
                                            <h:outputText value="#{creditRiskInfo.botClass}"/>
                                        </p:column>

                                        <p:column styleClass="center">
                                            <h:outputText value="#{creditRiskInfo.reason}"/>
                                        </p:column>

                                        <p:column styleClass="center">
                                            <h:outputText value="#{creditRiskInfo.lastReviewDate}">
                                                <f:convertDateTime pattern="dd/MM/yyyy" locale="th_TH"/>
                                            </h:outputText>
                                        </p:column>

                                        <p:column styleClass="center">
                                            <h:outputText value="#{creditRiskInfo.nextReviewDate}">
                                                <f:convertDateTime pattern="dd/MM/yyyy" locale="th_TH"/>
                                            </h:outputText>
                                        </p:column>

                                        <p:column styleClass="center">
                                            <h:outputText value="#{creditRiskInfo.extendedReviewDate != null ? creditRiskInfo.extendedReviewDate : '-'}">
                                                <f:convertDateTime pattern="dd/MM/yyyy" locale="th_TH"/>
                                            </h:outputText>
                                        </p:column>

                                        <p:column styleClass="center">
                                            <h:outputText value="#{creditRiskInfo.indirectCountryName}"/>
                                        </p:column>

                                        <p:column styleClass="center">
                                            <h:outputText value="#{creditRiskInfo.percentExport}"/>
                                        </p:column>
                                    </p:dataTable>
                                </td>
                            </tr>
                        </table>
                        <!-- end content -->
                    </td>
                </tr>

                <tr>
                    <td colspan="2" style="padding-top: 10px;">
                        <div class="separate"><!-- --></div>
                    </td>
                </tr>

                <!-- Deviate -->
                <tr>
                    <td>
                        <!-- start content -->
                        <table class="content_table_form" style="width: 100%;">
                            <tr>
                                <td colspan="2" style="text-align: left" class="title">
                                    <h:outputText value="#{msg.get('app.exSummary.deviation.label.deviationReasonCaption')}"/>
                                </td>
                            </tr>
                            <tr>
                                <td colspan="2" style="text-align: left" class="title">
                                    <h:outputText value="#{msg.get('app.exSummary.deviation.label.deviationReasonDetailCaption')}"/>
                                </td>

                            </tr>
                            <tr>
                                <td  colspan="2" style="text-align: left;width:10px;" class="title">
                                    <h:outputText value="#{msg.get('app.exSummary.deviation.label.applicationResult')}"/>
                                    <p:spacer width="10px;" />
                                    <h:outputText class="result #{executiveSummary.exSummaryView.applicationColorResult.resultClass}"
                                            value="#{executiveSummary.exSummaryView.applicationColorResult}"
                                            rendered="#{executiveSummary.exSummaryView.applicationColorResult != null}"/>
                                    <p:spacer width="10px;" />
                                    <h:outputText value="#{executiveSummary.exSummaryView.applicationResult}"/>
                                </td>
                            </tr>
                            <tr>
                                <td colspan="2">
                                    <p:commandButton value="#{msg.get('app.button.add')}"
                                                     styleClass="smaller"
                                                     process="@this"
                                                     actionListener="#{executiveSummary.onInitAddDeviate}"
                                                     update=":exSumDeviateDlgForm"
                                                     oncomplete="exSumDeviateDlg.show();">
                                        <p:resetInput target=":exSumDeviateDlgForm"/>
                                    </p:commandButton>
                                </td>
                            </tr>
                            <tr>
                                <td colspan="2">
                                    <p:dataTable style="width: 100%" id="decisionTable"
                                                 var="itemDecision" value="#{executiveSummary.exSummaryView.exSumDecisionListView}"
                                                 paginator="false" rowKey="#{itemDecision}"
                                                 rowIndexVar="rowIndex">

                                        <p:columnGroup type="header">
                                            <p:row>
                                                <p:column style="width:30px;"/>
                                                <p:column style="width:100px;"
                                                          headerText="#{msg.get('app.exSummary.tb.decision.label.flag')}"/>
                                                <p:column style="width:150px;"
                                                          headerText="#{msg.get('app.exSummary.tb.decision.label.group')}"/>
                                                <p:column style="width:200px;"
                                                          headerText="#{msg.get('app.exSummary.tb.decision.label.ruleName')}"/>
                                                <p:column style="width:200px;"
                                                          headerText="#{msg.get('app.exSummary.tb.decision.label.cusName')}"/>
                                                <p:column style="width:750px;"
                                                          headerText="#{msg.get('app.exSummary.tb.decision.label.deviationReason')}"/>
                                                <p:column style="width:50px;"/>
                                            </p:row>
                                        </p:columnGroup>

                                        <p:column styleClass="center">
                                            <h:outputText value="#{rowIndex+1}"/>
                                        </p:column>

                                        <p:column styleClass="center #{itemDecision.flag.resultClass}">
                                                <h:outputText value="#{itemDecision.flag}"/>
                                        </p:column>

                                        <p:column styleClass="center">
                                            <h:outputText value="#{itemDecision.group}"/>
                                        </p:column>

                                        <p:column styleClass="center">
                                            <h:outputText value="#{itemDecision.ruleName}"/>
                                        </p:column>

                                        <p:column styleClass="center">
                                            <h:outputText value="#{itemDecision.cusName}"/>
                                        </p:column>

                                        <p:column styleClass="center">
                                            <h:inputTextarea value="#{itemDecision.deviationReason}" style="width: 100%; margin-top: 5px; margin-left: -3px;"
                                                             required="#{itemDecision.flag == 'RED'}"/>
                                        </p:column>

                                        <p:column styleClass="center">
                                            <p:column headerText="" styleClass="center" style="width:54px;">
                                                <p:commandButton title="#{msg.get('app.button.edit')}"
                                                                 icon="ui-icon-pencil"
                                                                 action="#{executiveSummary.onSelectEditDeviate()}"
                                                                 update=":exSumDeviateDlgForm"
                                                                 oncomplete="exSumDeviateDlg.show();"
                                                                 rendered="#{itemDecision.canEdit}">
                                                    <f:setPropertyActionListener value="#{itemDecision}"
                                                                                 target="#{executiveSummary.selectDeviateDecision}"/>
                                                    <f:setPropertyActionListener value="#{rowIndex}"
                                                                                 target="#{executiveSummary.rowIndex}"/>
                                                    <p:resetInput target=":exSumDeviateDlgForm"/>
                                                </p:commandButton>

                                                <p:commandButton title="#{msg.get('app.button.remove')}"
                                                                 icon="ui-icon-trash"
                                                                 oncomplete="confirmDeleteDeviateDecisionDlg.show()"
                                                                 update=":frmMain:decisionTable"
                                                                 process="@form"
                                                                 rendered="#{itemDecision.canEdit}">
                                                    <f:setPropertyActionListener value="#{itemDecision}"
                                                                                 target="#{executiveSummary.selectDeviateDecision}"/>
                                                </p:commandButton>
                                            </p:column>
                                        </p:column>

                                    </p:dataTable>
                                </td>
                            </tr>
                        </table>
                        <!-- end content -->
                    </td>
                </tr>

                <tr>
                    <td colspan="2" style="padding-top: 10px;">
                        <div class="separate"><!-- --></div>
                    </td>
                </tr>

                <!-- Business Overview and Support Decision -->
                <tr>
                    <td>
                        <!-- start content -->
                        <table class="content_table_form">
                            <tr>
                                <td colspan="2" style="text-align: left" class="title">
                                    <h:outputText value="#{msg.get('app.exSummary.label.section.business.decision')}"/>
                                </td>
                            </tr>


                            <tr>
                                <td colspan="2" style="text-align: left">
                                    <h:outputText value="#{msg.get('app.exSummary.label.natureOfBusiness')}"/>
                                </td>
                            </tr>

                            <tr>
                                <td colspan="2" style="text-align: left">
                                    <h:inputTextarea cols="170" rows="5" value="#{executiveSummary.exSummaryView.natureOfBusiness}"
                                                     onblur="checkLengthText(this)" onkeydown="checkLengthText(this)"
                                                     onkeyup="checkLengthText(this)" onkeypress="checkLengthText(this)"/>
                                </td>
                            </tr>

                            <tr>
                                <td colspan="2" style="text-align: left">
                                    <h:outputText value="#{msg.get('app.exSummary.label.historicalAndReasonOfChange')}"/>
                                </td>
                            </tr>

                            <tr>
                                <td colspan="2" style="text-align: left">
                                    <h:inputTextarea cols="170" rows="5" value="#{executiveSummary.exSummaryView.historicalAndReasonOfChange}"
                                                     onblur="checkLengthText(this)" onkeydown="checkLengthText(this)"
                                                     onkeyup="checkLengthText(this)" onkeypress="checkLengthText(this)"/>
                                </td>
                            </tr>

                            <tr>
                                <td colspan="2" style="text-align: left">
                                    <h:outputText value="#{msg.get('app.exSummary.label.tmbCreditHistory')}"/>
                                </td>
                            </tr>

                            <tr>
                                <td colspan="2" style="text-align: left">
                                    <h:inputTextarea cols="170" rows="5" value="#{executiveSummary.exSummaryView.tmbCreditHistory}"
                                                     onblur="checkLengthText(this)" onkeydown="checkLengthText(this)"
                                                     onkeyup="checkLengthText(this)" onkeypress="checkLengthText(this)"/>
                                </td>
                            </tr>

                            <tr>
                                <td colspan="2" style="text-align: left">
                                    <h:outputText value="#{msg.get('app.exSummary.label.supportReason')}"/>
                                </td>
                            </tr>

                            <tr>
                                <td colspan="2" style="text-align: left">
                                    <h:inputTextarea cols="170" rows="5" value="#{executiveSummary.exSummaryView.supportReason}"
                                                     onblur="checkLengthText(this)" onkeydown="checkLengthText(this)"
                                                     onkeyup="checkLengthText(this)" onkeypress="checkLengthText(this)"/>
                                </td>
                            </tr>

                            <tr>
                                <td colspan="2" style="text-align: left; padding-top: 30px;" class="title">
                                    <h:outputText value="#{msg.get('app.exSummary.label.section.remark')}"/>
                                </td>
                            </tr>

                            <tr>
                                <td style="text-align: left; width: 200px;">
                                    <h:outputText value="#{msg.get('app.exSummary.label.RM008Code')}"/>
                                </td>
                                <td>
                                    <h:selectOneRadio id="RM008" value="#{executiveSummary.exSummaryView.rm008Code}">
                                        <f:selectItem itemLabel="#{msg.get('app.exSummary.label.radio.answer')}" itemValue="1"/>
                                        <f:selectItem itemLabel="#{msg.get('app.exSummary.label.radio.notAnswer')}" itemValue="0"/>
                                        <p:ajax update="RM008,rm008remark" listener="#{executiveSummary.onChangeRM008()}" event="click"/>
                                    </h:selectOneRadio>
                                </td>
                                <td></td>
                            </tr>

                            <tr>
                                <td colspan="2" style="text-align: left">
                                    <h:inputTextarea id="rm008remark" cols="170" rows="3" value="#{executiveSummary.exSummaryView.rm008Remark}"
                                                     disabled="#{executiveSummary.exSummaryView.rm008Code == 0}"
                                                     onblur="checkLengthText(this)" onkeydown="checkLengthText(this)"
                                                     onkeyup="checkLengthText(this)" onkeypress="checkLengthText(this)"/>
                                </td>
                            </tr>

                            <tr>
                                <td style="text-align: left; width: 200px;">
                                    <h:outputText value="#{msg.get('app.exSummary.label.RM204Code')}"/>
                                </td>
                                <td>
                                    <h:selectOneRadio id="RM204" value="#{executiveSummary.exSummaryView.rm204Code}">
                                        <f:selectItem itemLabel="#{msg.get('app.exSummary.label.radio.answer')}" itemValue="1"/>
                                        <f:selectItem itemLabel="#{msg.get('app.exSummary.label.radio.notAnswer')}" itemValue="0"/>
                                        <p:ajax update="RM204,rm204remark" listener="#{executiveSummary.onChangeRM204()}" event="click"/>
                                    </h:selectOneRadio>
                                </td>
                                <td></td>
                            </tr>

                            <tr>
                                <td colspan="2" style="text-align: left">
                                    <h:inputTextarea id="rm204remark" cols="170" rows="3" value="#{executiveSummary.exSummaryView.rm204Remark}"
                                                     disabled="#{executiveSummary.exSummaryView.rm204Code == 0}"
                                                     onblur="checkLengthText(this)" onkeydown="checkLengthText(this)"
                                                     onkeyup="checkLengthText(this)" onkeypress="checkLengthText(this)"/>
                                </td>
                            </tr>

                            <tr>
                                <td style="text-align: left; width: 200px;">
                                    <h:outputText value="#{msg.get('app.exSummary.label.RM020Code')}"/>
                                </td>
                                <td>
                                    <h:selectOneRadio id="RM020" value="#{executiveSummary.exSummaryView.rm020Code}">
                                        <f:selectItem itemLabel="#{msg.get('app.exSummary.label.radio.answer')}" itemValue="1"/>
                                        <f:selectItem itemLabel="#{msg.get('app.exSummary.label.radio.notAnswer')}" itemValue="0"/>
                                        <p:ajax update="RM020,rm020remark" listener="#{executiveSummary.onChangeRM020()}" event="click"/>
                                    </h:selectOneRadio>
                                </td>
                                <td></td>
                            </tr>

                            <tr>
                                <td colspan="4" style="text-align: left; width: 100%">
                                    <h:inputTextarea id="rm020remark" cols="170" rows="3" value="#{executiveSummary.exSummaryView.rm020Remark}"
                                                     disabled="#{executiveSummary.exSummaryView.rm020Code == 0}"
                                                     onblur="checkLengthText(this)" onkeydown="checkLengthText(this)"
                                                     onkeyup="checkLengthText(this)" onkeypress="checkLengthText(this)"/>
                                </td>
                            </tr>
                        </table>
                    </td>
                </tr>

                <tr>
                    <td colspan="2" style="padding-top: 10px;">
                        <div class="separate"><!-- --></div>
                    </td>
                </tr>

                <!-- UW Decision and Explanation -->
                <tr>
                    <td>
                        <!-- start content -->
                        <table class="content_table_form">
                            <tr>
                                <td colspan="4" style="text-align: left" class="title">
                                    <h:outputText value="#{msg.get('app.exSummary.label.section.uw.decision')}"/>
                                </td>
                            </tr>
                            <tr>
                                <td style="text-align: left;width:200px;" class="title">
                                    <h:outputText value="#{msg.get('app.exSummary.label.approveAuthority')}"/>
                                </td>
                                <td style="text-align: left; width:200px;">
                                    <p:selectOneMenu styleClass="largest" size="1"
                                                     style="width: 200px; max-width: 200px; min-width: 200px"
                                                     value="#{executiveSummary.exSummaryView.approveAuthority.id}"
                                                     disabled="#{not executiveSummary.roleUW}">
                                        <f:selectItem itemLabel="- Please Select -" itemValue=""/>
                                        <f:selectItems value="#{executiveSummary.authorizationDOAList}"
                                                       var="authoriz"
                                                       itemLabel="#{authoriz.name}"
                                                       itemValue="#{authoriz.id}"/>
                                    </p:selectOneMenu>
                                </td>
                                <td style="text-align: right; width: 150px; padding-right: 30px;" class="title">
                                    <h:outputText value="#{msg.get('app.exSummary.label.uwCode')}"/>
                                </td>
                                <td style="width: 150px;">
                                    <p:inputText value="#{executiveSummary.exSummaryView.uwCode}" readonly="true"/>
                                </td>
                            </tr>
                            <tr>
                                <td colspan="4" style="text-align: left">
                                    <h:selectOneRadio id="decision" value="#{executiveSummary.exSummaryView.decision}"
                                                      disabled="#{not executiveSummary.roleUW}">
                                        <f:selectItem itemLabel="#{msg.get('app.exSummary.label.radio.normal.approve')}" itemValue="1"/>
                                        <f:selectItem itemLabel="#{msg.get('app.exSummary.label.radio.deviation')}" itemValue="2"/>
                                        <f:selectItem itemLabel="#{msg.get('app.exSummary.label.radio.reject')}" itemValue="3"/>
                                        <p:ajax update="decision,reasonList,deviateTable" listener="#{executiveSummary.onChangeDeviate}" event="click"/>
                                    </h:selectOneRadio>
                                </td>
                            </tr>
                            <tr>
                                <td style="text-align: left; padding-top: 4px;" colspan="4">
                                    <p:selectOneMenu styleClass="largest" size="1" id="reasonList"
                                                     style="width: 900px; min-width: 900px; max-width: 900px;"
                                                     value="#{executiveSummary.reason.id}"
                                                     disabled="#{not executiveSummary.roleUW}">
                                        <f:selectItem itemLabel="- Please Select -" itemValue="0"/>
                                        <f:selectItems value="#{executiveSummary.reasonList}" var="reasonItem"
                                                       itemDescription="#{reasonItem.description}"
                                                       itemLabel="#{reasonItem.code} - #{reasonItem.description}"
                                                       itemValue="#{reasonItem.id}"/>
                                    </p:selectOneMenu>
                                </td>
                                <td style="text-align: left">
                                    <p:commandButton value="#{msg.get('app.addButton')}" styleClass="small" process="@form"
                                                     action="#{executiveSummary.onAddReason()}" update=":frmMain"
                                                     disabled="#{not executiveSummary.roleUW}"/>
                                </td>
                            </tr>

                            <!-- //Flag -->
                            <tr>
                                <td colspan="6" style="padding-top: 10px;">
                                    <p:dataTable id="deviateTable" value="#{executiveSummary.exSummaryView.deviateCode}"
                                                 var="itemUWDecision" style="width: 100%"
                                                 paginator="false" rowKey="#{itemUWDecision}"
                                                 rowIndexVar="rowIndex">
                                        <p:columnGroup type="header">
                                            <p:row>
                                                <p:column style="width:20px;"/>
                                                <p:column style="width:800px; max-width: 800px; min-width: 800px;"
                                                          headerText="#{msg.get('app.exSummary.label.tb.label.reasonCode')}"/>
                                                <p:column style="width:20px;"/>
                                            </p:row>
                                        </p:columnGroup>

                                        <p:column styleClass="center">
                                            <h:outputText value="#{rowIndex+1}"/>
                                        </p:column>

                                        <p:column styleClass="left" style="width:800px; max-width: 800px; min-width: 800px;">
                                            <h:outputText value="#{itemUWDecision.code} - #{itemUWDecision.description}"
                                                          style="width:800px; max-width: 800px; min-width: 800px;"/>
                                        </p:column>

                                        <p:column styleClass="center">
                                            <p:commandButton title="#{msg.get('app.button.remove')}"
                                                             icon="ui-icon-trash"
                                                             oncomplete="confirmDeleteDeviateDlg.show()"
                                                             update=":frmMain:deviateTable"
                                                             process="@form"
                                                             disabled="#{not executiveSummary.roleUW}">
                                                <f:setPropertyActionListener value="#{itemUWDecision}"
                                                                             target="#{executiveSummary.selectDeviate}"/>
                                            </p:commandButton>
                                        </p:column>
                                    </p:dataTable>
                                </td>
                            </tr>
                        </table>
                        <!-- end content -->
                    </td>
                </tr>

                <tr>
                    <td colspan="2">
                        <div class="separate"><!-- --></div>
                    </td>
                </tr>

                <!-- UW Comment -->
                <tr>
                    <td colspan="2" style="text-align: left" class="title">
                        <h:outputText
                                value="#{msg.get('app.exSummary.label.uwComment')}"/>
                    </td>
                </tr>
                <tr>
                    <td colspan="2" style="text-align: left">
                        <h:inputTextarea cols="170"
                                         rows="7"
                                         value="#{executiveSummary.exSummaryView.uwComment}"
                                         disabled="#{not executiveSummary.roleUW}"/>
                    </td>
                </tr>


                <tr>
                    <td colspan="2">
                        <div class="separate"><!-- --></div>
                    </td>
                </tr>

                <tr>
                    <td colspan="4" class="center">
                        <p:commandButton id="saveBtn" value="#{msg.get('app.button.save')}" styleClass="smaller"
                                         process="@form" update=":frmMain,:msgBoxSystemMessagePanel"
                                         actionListener="#{executiveSummary.onSaveExecutiveSummary}" binding="#{saveBtn}"/>
                        <p:commandButton value="#{msg.get('app.button.cancel')}" styleClass="small"
                                         process="@form" update=":frmMain"
                                         actionListener="#{executiveSummary.onCreation}"/>
                    </td>
                </tr>
                </table>
                <!-- end content -->
                </div>
                </div>
                <div id="bottom_line"><!-- --></div>
                </div>
                <div class="clear"></div>
                <!-- Start Footer -->
                <ui:include src="include/footer.xhtml"/>
                <!-- End Footer -->
            </div>
        </h:form>

    <p:blockUI block=":frmMain" trigger=":frmMain:saveBtn">
        LOADING<br/>
        <p:graphicImage value="/resources/images/shared/ajax-loader.gif"/>
    </p:blockUI>

    </p:panel>

    <ui:include src="dialog/confirmDeleteDlg.xhtml">
        <ui:param name="id" value="confirmDeleteDeviateDialog"/>
        <ui:param name="name" value="confirmDeleteDeviateDlg"/>
        <ui:param name="formId" value="frmConfirmDeleteDeviate"/>
        <ui:param name="controller" value="#{executiveSummary}"/>
        <ui:param name="action" value="onDeleteDeviate"/>
        <ui:param name="update" value=":frmMain"/>
    </ui:include>

    <ui:include src="dialog/confirmDeleteDlg.xhtml">
        <ui:param name="id" value="confirmDeleteDeviateDecisionDialog"/>
        <ui:param name="name" value="confirmDeleteDeviateDecisionDlg"/>
        <ui:param name="formId" value="frmconfirmDeleteDeviateDecision"/>
        <ui:param name="controller" value="#{executiveSummary}"/>
        <ui:param name="action" value="onDeleteDeviateDecision"/>
        <ui:param name="update" value=":frmMain"/>
    </ui:include>

    <p:panel id="msgBoxSystemMessagePanel" styleClass="panel">
        <p:confirmDialog id="msgBoxSystemMessageDialog" widgetVar="msgBoxSystemMessageDlg" closable="false"
                         severity="#{executiveSummary.severity}" header="#{executiveSummary.messageHeader}">
            <f:facet name="message">
                <h:outputText value="#{executiveSummary.message}" escape="false"/>
            </f:facet>
            <p:commandButton value="OK"
                             process="@this"
                             update="frmMain"
                             oncomplete="msgBoxSystemMessageDlg.hide()"/>
        </p:confirmDialog>
    </p:panel>

    <p:dialog id="exSumDeviateDialog" header="Deviate Information" widgetVar="exSumDeviateDlg" resizable="false"
              modal="true" width="490" height="120" closable="false">
        <ui:include src="dialog/exSumDeviateDialog.xhtml"/>
    </p:dialog>

</h:body>
</f:view>
</html>