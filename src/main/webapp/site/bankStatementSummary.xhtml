<!DOCTYPE html>
<html>
<f:view xmlns="http://www.w3.org/1999/xhtml"
        xmlns:f="http://java.sun.com/jsf/core"
        xmlns:h="http://java.sun.com/jsf/html"
        xmlns:ui="http://java.sun.com/jsf/facelets"
        xmlns:p="http://primefaces.org/ui"
        xmlns:fn="http://java.sun.com/jsp/jstl/functions"
        xmlns:clv="http://clevel.com/ui">

<h:head>
    <title>SE-LOS : Bank Statement Summary</title>
    <h:outputStylesheet name="css/style.css" />
    <!--<script type="text/javascript" language="javascript" src="#{request.contextPath}/resources/js/jquery.numeric.js"></script>-->
    <h:outputScript library="js" name="custom.js" />
    <h:outputScript library="js" name="jquery.ui.datepicker.min.js" />
    <style type="text/css">
        .ui-datatable thead th {
            white-space: normal !important;
        }
        .ui-datatable tbody td {
            border-color: #868686 !important;
        }
        .calendar_right input {
            background: #ffffff !important;
            border: 1px solid #868686 !important;
        }
    </style>
</h:head>

<h:body>
    <p:panel id="pnl_maincontainer" style="border:0; margin:0; padding: 0;">
        <h:form id="frmMain">
            <div id="main_container">
            <!-- Start Header Logo -->
            <ui:include src="include/header_logo.xhtml"/>
            <!-- End Header Logo -->
            <!-- Start Header Detail -->
            <ui:include src="include/header_detail.xhtml"/>
            <!-- End Header Detail -->
            <!-- Start Menu -->
            <ui:include src="include/menubar.xhtml"/>
            <!-- End Menu -->
            <div id="content_container">
                <div id="content_name">#{msg.get('app.bankStmtSum.header')}</div>
                <div id="content">
                    <div id="content_info">
                        <div id="content_trackchange" title="Click to view Track Change">[ View Track Change ]</div>
                        <div id="content_lastupdate">Last update by <h:outputText id="lastupdateName" value="MR.BDM Maker"/>, <h:outputText
                                id="lastupdateTime" value="18/08/2556 11:11:01"/></div>
                    </div>

                    <div id="content_form">
                    <!-- start content -->
                    <table class="content_table_form">
                        <tr>
                            <td class="title" style="min-width: 143px; width: 143px; max-width: 143px;">
                                <h:outputText value="#{msg.get('app.bankStmtSum.label.seasonal')}"/>
                            </td>
                            <td class="left" style="min-width: 900px; width: 900px; max-width: 900px;">
                                <p:selectOneRadio value="#{bankStatementSummary.seasonalFlag}">
                                    <f:selectItem itemLabel="#{msg.get('app.button.no')}" itemValue="1"/>
                                    <f:selectItem itemLabel="#{msg.get('app.button.yes')}" itemValue="2"/>
                                    <p:ajax event="change"
                                            listener="#{bankStatementSummary.onChangeSeasonalFlag()}"
                                            process="@this"
                                            update="@this,"/>
                                </p:selectOneRadio>
                            </td>
                        </tr>

                        <tr>
                            <td class="title">
                                <h:outputText value="#{msg.get('app.bankStmtSum.label.expectSubmissionDate')}"/>
                            </td>
                            <td class="left">
                                <table border="0">
                                    <tr>
                                        <td style="border-style: none !important;">
                                            <clv:BECalendar id="expectSumitDate" showOn="both" showButtonPanel="true" navigator="true"
                                                            yearRange="1950:2100"
                                                            defaultdate="#{bankStatementSummary.currentDateDDMMYY}"
                                                            mindate="#{bankStatementSummary.currentDateDDMMYY}"
                                                            pattern="dd/MM/yyyy"
                                                            value="#{bankStatementSummary.expectedSubmitDate}"
                                                            locale="th_TH"
                                                            readonlyInput="true"
                                                            required="#{not empty param[saveButton.clientId] || not empty param[refreshButton.clientId]}"
                                                            styleClass="calendar_right">
                                            </clv:BECalendar>
                                        </td>
                                        <td style="border-style: none !important; padding-left: 5px;">
                                            <p:commandButton id="btnRefresh" value="#{msg.get('app.button.refresh')}"
                                                             binding="#{refreshButton}"
                                                             disabled="#{bankStatementSummary.disableRefresh}"
                                                             action="#{bankStatementSummary.onRefresh()}"
                                                             process="@form"
                                                             update=":frmMain"
                                                             styleClass="smaller"/>
                                        </td>
                                    </tr>
                                </table>
                            </td>
                        </tr>

                        <tr>
                            <td colspan="2">
                                <div class="separate"><!-- --></div>
                            </td>
                        </tr>

                        <!-- New table -->
                        <tr>
                            <td class="left title" colspan="2">
                                <h:outputText value="#{msg.get('app.bankStmtSum.label.tmbBankStmtSum')}"/>
                                <p:spacer width="25" height="0"/>
                                <p:commandButton id="btnAddTmbBank" value="#{msg.get('app.button.add')}"
                                                 action="#{bankStatementSummary.onClickAddTMBBankStmt()}"
                                                 process=":frmMain"
                                                 update=":frmMain,:msgBoxSystemMessagePanel,:confirmChangeScreenBankStmtDialog"
                                                 styleClass="smaller"/>
                            </td>
                        </tr>

                        <tr>
                            <td class="left" colspan="2">

                                <div class="ui-datatable ui-widget">
                                    <div class="ui-datatable-tablewrapper">
                                        <table style="width: 100%">
                                            <!-- TMB Bank Statement -->
                                            <thead>
                                                <tr>
                                                    <th rowspan="2" style="width: 25px" class="ui-state-default">#{msg.get('app.bankStmtSum.table.column.no')}</th>
                                                    <th rowspan="2" style="width: 80px" class="ui-state-default">#{msg.get('app.bankStmtSum.table.column.accountName')}</th>
                                                    <th rowspan="2" style="width: 70px" class="ui-state-default">#{msg.get('app.bankStmtSum.table.column.accountNo')}</th>
                                                    <th rowspan="2" style="width: 60px" class="ui-state-default">#{msg.get('app.bankStmtSum.table.column.accountType')}</th>
                                                    <th rowspan="2" style="width: 40px" class="ui-state-default">#{msg.get('app.bankStmtSum.table.column.main')}</th>
                                                    <th rowspan="2" style="width: 100px" class="ui-state-default">#{msg.get('app.bankStmtSum.table.column.limit')}</th>
                                                    <th rowspan="2" style="width: 100px" class="ui-state-default">#{msg.get('app.bankStmtSum.table.column.incomeGross')}</th>
                                                    <th colspan="2" class="ui-state-default">#{msg.get('app.bankStmtSum.table.column.incomeNet')}</th>
                                                    <th rowspan="2" style="width: 50px" class="ui-state-default">#{msg.get('app.bankStmtSum.table.column.utilization')}</th>
                                                    <th rowspan="2" style="width: 40px" class="ui-state-default">#{msg.get('app.bankStmtSum.table.column.swing')}</th>
                                                    <th colspan="2" class="ui-state-default">#{msg.get('app.bankStmtSum.table.column.overLimit')}</th>
                                                    <th rowspan="2" style="width: 55px" class="ui-state-default">#{msg.get('app.bankStmtSum.table.column.chequeReturn')}</th>
                                                    <th rowspan="2" style="width: 55px" class="ui-state-default">#{msg.get('app.bankStmtSum.table.column.cashFlowLimit')}</th>
                                                    <th colspan="2" class="ui-state-default">#{msg.get('app.bankStmtSum.table.column.trdChequeReturn')}</th>
                                                    <th rowspan="2" style="width: 55px" class="ui-state-default"></th>
                                                </tr>
                                                <tr>
                                                    <th style="width: 100px" class="ui-state-default">#{msg.get('app.bankStmtSum.table.column.incomeNet.BDM')}</th>
                                                    <th style="width: 100px" class="ui-state-default">#{msg.get('app.bankStmtSum.table.column.incomeNet.UW')}</th>
                                                    <th style="width: 40px" class="ui-state-default">#{msg.get('app.bankStmtSum.table.column.overLimit.times')}</th>
                                                    <th style="width: 40px" class="ui-state-default">#{msg.get('app.bankStmtSum.table.column.overLimit.days')}</th>
                                                    <th style="width: 65px" class="ui-state-default">#{msg.get('app.bankStmtSum.table.column.trdChequeReturn.amount')}</th>
                                                    <th style="width: 65px" class="ui-state-default">#{msg.get('app.bankStmtSum.table.column.trdChequeReturn.percent')}</th>
                                                </tr>
                                            </thead>

                                            <tbody class="ui-datatable-data ui-widget-content">
                                            <ui:repeat value="#{bankStatementSummary.summaryView.tmbBankStmtViewList}"
                                                       var="item" varStatus="i">
                                                <tr>
                                                    <td class="center top">
                                                        <h:outputText value="#{i.index + 1}"/>
                                                    </td>

                                                    <td class="left top">
                                                        <h:outputText value="#{item.accountName}"/>
                                                    </td>

                                                    <td class="center top">
                                                        <h:outputText value="#{item.accountNumber}"/>
                                                    </td>

                                                    <td class="center top">
                                                        <h:outputText value="#{item.bankAccountTypeView.name}"
                                                                      rendered="#{not empty item.bankAccountTypeView}"/>
                                                        <h:outputText value="#{bankStatementSummary.getOtherBankAccType(item.otherAccountType)}"
                                                                      rendered="#{item.otherAccountType gt 0}"/>
                                                    </td>

                                                    <td class="center top">
                                                        <h:outputText value="#{item.mainAccount eq bankStatementSummary.yesValue ? 'Y' : ''}"/>
                                                    </td>

                                                    <td class="right top">
                                                        <h:outputText value="#{item.avgLimit}">
                                                            <f:convertNumber pattern="#,##0.##" minFractionDigits="2" maxFractionDigits="2" maxIntegerDigits="14"/>
                                                        </h:outputText>
                                                    </td>

                                                    <td class="right top">
                                                        <h:outputText value="#{item.avgIncomeGross}">
                                                            <f:convertNumber pattern="#,##0.##" minFractionDigits="2" maxFractionDigits="2" maxIntegerDigits="14"/>
                                                        </h:outputText>
                                                    </td>

                                                    <td class="right top">
                                                        <h:outputText value="#{item.avgIncomeNetBDM}">
                                                            <f:convertNumber pattern="#,##0.##" minFractionDigits="2" maxFractionDigits="2" maxIntegerDigits="14"/>
                                                        </h:outputText>
                                                    </td>

                                                    <td class="right top">
                                                        <h:outputText value="#{item.avgIncomeNetUW}">
                                                            <f:convertNumber pattern="#,##0.##" minFractionDigits="2" maxFractionDigits="2" maxIntegerDigits="14"/>
                                                        </h:outputText>
                                                    </td>

                                                    <td class="right top">
                                                        <h:outputText value="#{item.avgUtilizationPercent}">
                                                            <f:convertNumber pattern="#,##0.##" minFractionDigits="2" maxFractionDigits="2" maxIntegerDigits="14"/>
                                                        </h:outputText>
                                                        <h:outputText value="%"/>
                                                    </td>

                                                    <td class="right top">
                                                        <h:outputText value="#{item.avgSwingPercent}">
                                                            <f:convertNumber pattern="#,##0.##" minFractionDigits="2" maxFractionDigits="2" maxIntegerDigits="14"/>
                                                        </h:outputText>
                                                        <h:outputText value="%"/>
                                                    </td>

                                                    <td class="center top">
                                                        <h:outputText value="#{item.overLimitTimes}">
                                                            <f:convertNumber pattern="#,##0" minFractionDigits="0" maxFractionDigits="0" maxIntegerDigits="14"/>
                                                        </h:outputText>
                                                    </td>

                                                    <td class="center top">
                                                        <h:outputText value="#{item.overLimitDays}">
                                                            <f:convertNumber pattern="#,##0" minFractionDigits="0" maxFractionDigits="0" maxIntegerDigits="14"/>
                                                        </h:outputText>
                                                    </td>

                                                    <td class="center top">
                                                        <h:outputText value="#{item.chequeReturn}">
                                                            <f:convertNumber pattern="#,##0" minFractionDigits="0" maxFractionDigits="0" maxIntegerDigits="14"/>
                                                        </h:outputText>
                                                    </td>

                                                    <td class="right top">
                                                        <h:outputText value="#{item.avgGrossInflowPerLimit}">
                                                            <f:convertNumber pattern="#,##0.##" minFractionDigits="2" maxFractionDigits="2" maxIntegerDigits="14"/>
                                                        </h:outputText>
                                                        <h:outputText value="%"/>
                                                    </td>

                                                    <td class="right top">
                                                        <h:outputText value="#{item.trdChequeReturnAmount}">
                                                            <f:convertNumber pattern="#,##0.##" minFractionDigits="2" maxFractionDigits="2" maxIntegerDigits="14"/>
                                                        </h:outputText>
                                                    </td>

                                                    <td class="right top">
                                                        <h:outputText value="#{item.trdChequeReturnPercent}">
                                                            <f:convertNumber pattern="#,##0.##" minFractionDigits="2" maxFractionDigits="2" maxIntegerDigits="14"/>
                                                        </h:outputText>
                                                        <h:outputText value="%"/>
                                                    </td>

                                                    <td class="option top">
                                                        <p:commandButton title="#{msg.get('app.button.edit')}"
                                                                         icon="ui-icon-pencil"
                                                                         action="#{bankStatementSummary.onEditTmbBankStmt()}"
                                                                         onclick="blockUI.show()"
                                                                         onsuccess="blockUI.hide()">
                                                            <f:setPropertyActionListener value="#{item}"
                                                                                         target="#{bankStatementSummary.selectedBankStmtView}"/>
                                                        </p:commandButton>

                                                        <p:commandButton title="#{msg.get('app.button.delete')}"
                                                                         icon="ui-icon-trash"
                                                                         oncomplete="confirmDeleteBankStmtDlg.show()">
                                                            <f:setPropertyActionListener value="#{item}"
                                                                                         target="#{bankStatementSummary.selectedBankStmtView}"/>
                                                        </p:commandButton>
                                                    </td>
                                                </tr>
                                            </ui:repeat>
                                            </tbody>

                                            <!-- TMB Bank Statement Total -->
                                            <tr>
                                                <td class="summary_column" style="text-align: left;" colspan="6">
                                                    #{msg.get('app.bankStmtSum.totalIncome')}
                                                </td>
                                                <td class="summary_column" style="text-align: right;">
                                                    <h:outputText value="#{bankStatementSummary.summaryView.TMBTotalIncomeGross}">
                                                        <f:convertNumber pattern="#,##0.##"
                                                                         minFractionDigits="2" maxFractionDigits="2" maxIntegerDigits="14"/>
                                                    </h:outputText>
                                                </td>
                                                <td class="summary_column" style="text-align: right;">
                                                    <h:outputText value="#{bankStatementSummary.summaryView.TMBTotalIncomeNetBDM}">
                                                        <f:convertNumber pattern="#,##0.##"
                                                                         minFractionDigits="2" maxFractionDigits="2" maxIntegerDigits="14"/>
                                                    </h:outputText>
                                                </td>
                                                <td class="summary_column" style="text-align: right;">
                                                    <h:outputText value="#{bankStatementSummary.summaryView.TMBTotalIncomeNetUW}">
                                                        <f:convertNumber pattern="#,##0.##"
                                                                         minFractionDigits="2" maxFractionDigits="2" maxIntegerDigits="14"/>
                                                    </h:outputText>
                                                </td>
                                                <td class="summary_column" colspan="9"></td>
                                            </tr>

                                            <tr>
                                                <td colspan="18" style="height: 40px !important;"></td>
                                            </tr>

                                            <!-- Other Bank Statement -->
                                            <tr>
                                                <td colspan="18" class="left title" style="padding-top: 10px !important; padding-bottom: 5px !important;">
                                                    <h:outputText value="#{msg.get('app.bankStmtSum.label.otherBankStmtSum')}"/>
                                                    <p:spacer width="10" height="0"/>
                                                    <p:commandButton id="btnAddOthBank" value="#{msg.get('app.button.add')}"
                                                                     action="#{bankStatementSummary.onClickAddOtherBankStmt()}"
                                                                     process=":frmMain"
                                                                     update=":frmMain,:msgBoxSystemMessagePanel,:confirmChangeScreenBankStmtDialog"
                                                                     styleClass="smaller"/>
                                                </td>
                                            </tr>

                                            <thead>
                                                <tr>
                                                    <th rowspan="2" style="width: 25px" class="ui-state-default">#{msg.get('app.bankStmtSum.table.column.no')}</th>
                                                    <th rowspan="2" style="width: 80px" class="ui-state-default">#{msg.get('app.bankStmtSum.table.column.accountName')}</th>
                                                    <th rowspan="2" style="width: 70px" class="ui-state-default">#{msg.get('app.bankStmtSum.table.column.accountNo')}</th>
                                                    <th rowspan="2" style="width: 60px" class="ui-state-default">#{msg.get('app.bankStmtSum.table.column.accountType')}</th>
                                                    <th rowspan="2" style="width: 40px" class="ui-state-default">#{msg.get('app.bankStmtSum.table.column.main')}</th>
                                                    <th rowspan="2" style="width: 100px" class="ui-state-default">#{msg.get('app.bankStmtSum.table.column.limit')}</th>
                                                    <th rowspan="2" style="width: 100px" class="ui-state-default">#{msg.get('app.bankStmtSum.table.column.incomeGross')}</th>
                                                    <th colspan="2" class="ui-state-default">#{msg.get('app.bankStmtSum.table.column.incomeNet')}</th>
                                                    <th rowspan="2" style="width: 50px" class="ui-state-default">#{msg.get('app.bankStmtSum.table.column.utilization')}</th>
                                                    <th rowspan="2" style="width: 40px" class="ui-state-default">#{msg.get('app.bankStmtSum.table.column.swing')}</th>
                                                    <th colspan="2" class="ui-state-default">#{msg.get('app.bankStmtSum.table.column.overLimit')}</th>
                                                    <th rowspan="2" style="width: 55px" class="ui-state-default">#{msg.get('app.bankStmtSum.table.column.chequeReturn')}</th>
                                                    <th rowspan="2" style="width: 55px" class="ui-state-default">#{msg.get('app.bankStmtSum.table.column.cashFlowLimit')}</th>
                                                    <th colspan="2" class="ui-state-default">#{msg.get('app.bankStmtSum.table.column.trdChequeReturn')}</th>
                                                    <th rowspan="2" style="width: 55px" class="ui-state-default"></th>
                                                </tr>
                                                <tr>
                                                    <th style="width: 100px" class="ui-state-default">#{msg.get('app.bankStmtSum.table.column.incomeNet.BDM')}</th>
                                                    <th style="width: 100px" class="ui-state-default">#{msg.get('app.bankStmtSum.table.column.incomeNet.UW')}</th>
                                                    <th style="width: 40px" class="ui-state-default">#{msg.get('app.bankStmtSum.table.column.overLimit.times')}</th>
                                                    <th style="width: 40px" class="ui-state-default">#{msg.get('app.bankStmtSum.table.column.overLimit.days')}</th>
                                                    <th style="width: 65px" class="ui-state-default">#{msg.get('app.bankStmtSum.table.column.trdChequeReturn.amount')}</th>
                                                    <th style="width: 65px" class="ui-state-default">#{msg.get('app.bankStmtSum.table.column.trdChequeReturn.percent')}</th>
                                                </tr>
                                            </thead>

                                            <tbody class="ui-datatable-data ui-widget-content">
                                            <ui:repeat value="#{bankStatementSummary.summaryView.othBankStmtViewList}"
                                                       var="item" varStatus="i">
                                                <tr>
                                                    <td class="center top">
                                                        <h:outputText value="#{i.index + 1}"/>
                                                    </td>

                                                    <td class="left top">
                                                        <h:outputText value="#{item.accountName}"/>
                                                    </td>

                                                    <td class="center top">
                                                        <h:outputText value="#{item.accountNumber}"/>
                                                    </td>

                                                    <td class="center top">
                                                        <h:outputText value="#{item.bankAccountTypeView.name}"
                                                                      rendered="#{not empty item.bankAccountTypeView}"/>
                                                        <h:outputText value="#{bankStatementSummary.getOtherBankAccType(item.otherAccountType)}"
                                                                      rendered="#{item.otherAccountType gt 0}"/>
                                                    </td>

                                                    <td class="center top">
                                                        <h:outputText value="#{item.mainAccount eq bankStatementSummary.yesValue ? 'Y' : ''}"/>
                                                    </td>

                                                    <td class="right top">
                                                        <h:outputText value="#{item.avgLimit}">
                                                            <f:convertNumber pattern="#,##0.##" minFractionDigits="2" maxFractionDigits="2" maxIntegerDigits="14"/>
                                                        </h:outputText>
                                                    </td>

                                                    <td class="right top">
                                                        <h:outputText value="#{item.avgIncomeGross}">
                                                            <f:convertNumber pattern="#,##0.##" minFractionDigits="2" maxFractionDigits="2" maxIntegerDigits="14"/>
                                                        </h:outputText>
                                                    </td>

                                                    <td class="right top">
                                                        <h:outputText value="#{item.avgIncomeNetBDM}">
                                                            <f:convertNumber pattern="#,##0.##" minFractionDigits="2" maxFractionDigits="2" maxIntegerDigits="14"/>
                                                        </h:outputText>
                                                    </td>

                                                    <td class="right top">
                                                        <h:outputText value="#{item.avgIncomeNetUW}">
                                                            <f:convertNumber pattern="#,##0.##" minFractionDigits="2" maxFractionDigits="2" maxIntegerDigits="14"/>
                                                        </h:outputText>
                                                    </td>

                                                    <td class="right top">
                                                        <h:outputText value="#{item.avgUtilizationPercent}">
                                                            <f:convertNumber pattern="#,##0.##" minFractionDigits="2" maxFractionDigits="2" maxIntegerDigits="14"/>
                                                        </h:outputText>
                                                        <h:outputText value="%"/>
                                                    </td>

                                                    <td class="right top">
                                                        <h:outputText value="#{item.avgSwingPercent}">
                                                            <f:convertNumber pattern="#,##0.##" minFractionDigits="2" maxFractionDigits="2" maxIntegerDigits="14"/>
                                                        </h:outputText>
                                                        <h:outputText value="%"/>
                                                    </td>

                                                    <td class="center top">
                                                        <h:outputText value="#{item.overLimitTimes}">
                                                            <f:convertNumber pattern="#,##0" minFractionDigits="0" maxFractionDigits="0" maxIntegerDigits="14"/>
                                                        </h:outputText>
                                                    </td>

                                                    <td class="center top">
                                                        <h:outputText value="#{item.overLimitDays}">
                                                            <f:convertNumber pattern="#,##0" minFractionDigits="0" maxFractionDigits="0" maxIntegerDigits="14"/>
                                                        </h:outputText>
                                                    </td>

                                                    <td class="center top">
                                                        <h:outputText value="#{item.chequeReturn}">
                                                            <f:convertNumber pattern="#,##0" minFractionDigits="0" maxFractionDigits="0" maxIntegerDigits="14"/>
                                                        </h:outputText>
                                                    </td>

                                                    <td class="right top">
                                                        <h:outputText value="#{item.avgGrossInflowPerLimit}">
                                                            <f:convertNumber pattern="#,##0.##" minFractionDigits="2" maxFractionDigits="2" maxIntegerDigits="14"/>
                                                        </h:outputText>
                                                        <h:outputText value="%"/>
                                                    </td>

                                                    <td class="right top">
                                                        <h:outputText value="#{item.trdChequeReturnAmount}">
                                                            <f:convertNumber pattern="#,##0.##" minFractionDigits="2" maxFractionDigits="2" maxIntegerDigits="14"/>
                                                        </h:outputText>
                                                    </td>

                                                    <td class="right top">
                                                        <h:outputText value="#{item.trdChequeReturnPercent}">
                                                            <f:convertNumber pattern="#,##0.##" minFractionDigits="2" maxFractionDigits="2" maxIntegerDigits="14"/>
                                                        </h:outputText>
                                                        <h:outputText value="%"/>
                                                    </td>

                                                    <td class="option top">
                                                        <p:commandButton title="#{msg.get('app.button.edit')}"
                                                                         icon="ui-icon-pencil"
                                                                         action="#{bankStatementSummary.onEditOthBankStmt()}"
                                                                         onclick="blockUI.show()"
                                                                         onsuccess="blockUI.hide()">
                                                            <f:setPropertyActionListener value="#{item}"
                                                                                         target="#{bankStatementSummary.selectedBankStmtView}"/>
                                                        </p:commandButton>

                                                        <p:commandButton title="#{msg.get('app.button.delete')}"
                                                                         icon="ui-icon-trash"
                                                                         oncomplete="confirmDeleteBankStmtDlg.show()">
                                                            <f:setPropertyActionListener value="#{item}"
                                                                                         target="#{bankStatementSummary.selectedBankStmtView}"/>
                                                        </p:commandButton>
                                                    </td>
                                                </tr>


                                            </ui:repeat>
                                            </tbody>

                                            <!-- Other Bank Statement Total -->
                                            <tr>
                                                <td class="summary_column" style="text-align: left;" colspan="6">
                                                    #{msg.get('app.bankStmtSum.totalIncome')}
                                                </td>
                                                <td class="summary_column" style="text-align: right;">
                                                    <h:outputText value="#{bankStatementSummary.summaryView.othTotalIncomeGross}">
                                                        <f:convertNumber pattern="#,##0.##"
                                                                         minFractionDigits="2" maxFractionDigits="2" maxIntegerDigits="14"/>
                                                    </h:outputText>
                                                </td>
                                                <td class="summary_column" style="text-align: right;">
                                                    <h:outputText value="#{bankStatementSummary.summaryView.othTotalIncomeNetBDM}">
                                                        <f:convertNumber pattern="#,##0.##"
                                                                         minFractionDigits="2" maxFractionDigits="2" maxIntegerDigits="14"/>
                                                    </h:outputText>
                                                </td>
                                                <td class="summary_column" style="text-align: right;">
                                                    <h:outputText value="#{bankStatementSummary.summaryView.othTotalIncomeNetUW}">
                                                        <f:convertNumber pattern="#,##0.##"
                                                                         minFractionDigits="2" maxFractionDigits="2" maxIntegerDigits="14"/>
                                                    </h:outputText>
                                                </td>
                                                <td class="summary_column" colspan="9"></td>
                                            </tr>

                                            <tr>
                                                <td colspan="18" style="height:28px;"></td>
                                            </tr>

                                            <!-- Grand Total -->
                                            <tr>
                                                <td class="summary_column" style="text-align: left;" colspan="6">
                                                    #{msg.get('app.bankStmtSum.grandTotal')}
                                                </td>
                                                <td class="summary_column" style="text-align: right;">
                                                    <h:outputText value="#{bankStatementSummary.summaryView.grdTotalIncomeGross}">
                                                        <f:convertNumber pattern="#,##0.##"
                                                                         minFractionDigits="2" maxFractionDigits="2" maxIntegerDigits="14"/>
                                                    </h:outputText>
                                                </td>
                                                <td class="summary_column" style="text-align: right;">
                                                    <h:outputText value="#{bankStatementSummary.summaryView.grdTotalIncomeNetBDM}">
                                                        <f:convertNumber pattern="#,##0.##"
                                                                         minFractionDigits="2" maxFractionDigits="2" maxIntegerDigits="14"/>
                                                    </h:outputText>
                                                </td>
                                                <td class="summary_column" style="text-align: right;">
                                                    <h:outputText value="#{bankStatementSummary.summaryView.grdTotalIncomeNetUW}">
                                                        <f:convertNumber pattern="#,##0.##"
                                                                         minFractionDigits="2" maxFractionDigits="2" maxIntegerDigits="14"/>
                                                    </h:outputText>
                                                </td>
                                                <td class="summary_column" colspan="6"></td>
                                                <td class="summary_column" style="text-align: right;">
                                                    <h:outputText value="#{bankStatementSummary.summaryView.grdTotalTDChqRetAmount}">
                                                        <f:convertNumber pattern="#,##0.##"
                                                                         minFractionDigits="2" maxFractionDigits="2" maxIntegerDigits="14"/>
                                                    </h:outputText>
                                                </td>
                                                <td class="summary_column" style="text-align: right;">
                                                    <h:outputText value="#{bankStatementSummary.summaryView.grdTotalTDChqRetPercent}">
                                                        <f:convertNumber pattern="#,##0.##"
                                                                         minFractionDigits="2" maxFractionDigits="2" maxIntegerDigits="14"/>
                                                    </h:outputText>
                                                </td>
                                                <td class="summary_column"></td>
                                            </tr>

                                        </table>
                                    </div>
                                </div>

                            </td>
                        </tr>

                        <tr>
                            <td colspan="2" style="height:28px;"></td>
                        </tr>

                        <tr>
                            <td colspan="2">
                                <div class="separate"><!-- --></div>
                            </td>
                        </tr>

                        <!-- Source of Collateral Proof -->
                        <tr>
                            <td class="title left" colspan="2">
                                <h:outputText value="#{msg.get('app.bankStmtSum.label.srcOfCollateralProof')}"/>
                            </td>
                        </tr>

                        <tr>
                            <td class="left" colspan="2">
                                <p:dataTable id="dtSrcOfCollateralProof"
                                             var="item" value="#{bankStatementSummary.bankStmtSrcOfCollateralProofList}"
                                             paginator="false" rowKey="#{item}" rowIndexVar="rowIndex"
                                             style="width: 100%">

                                    <p:columnGroup type="header">
                                        <p:row>
                                            <p:column rowspan="2" headerText="#{msg.get('app.bankStmtSum.table.column.accountName')}" style="width:150px"/>
                                            <p:column rowspan="2" headerText="#{msg.get('app.bankStmtSum.table.column.accountNo')}" style="width:120px"/>
                                            <p:column rowspan="2" headerText="#{msg.get('app.bankStmtSum.table.column.accountType')}" style="width:100px"/>
                                            <p:column colspan="2" style="width:200px">
                                                <f:facet name="header">
                                                    <h:outputText value="#{bankStatementSummary.lastThreeMonth1}"
                                                                  rendered="#{not empty bankStatementSummary.lastThreeMonth1}">
                                                        <f:convertDateTime pattern="MMM yyyy" locale="th_TH"/>
                                                    </h:outputText>
                                                </f:facet>
                                            </p:column>

                                            <p:column colspan="2" style="width:200px">
                                                <f:facet name="header">
                                                    <h:outputText value="#{bankStatementSummary.lastThreeMonth2}"
                                                                  rendered="#{not empty bankStatementSummary.lastThreeMonth2}">
                                                        <f:convertDateTime pattern="MMM yyyy" locale="th_TH"/>
                                                    </h:outputText>
                                                </f:facet>
                                            </p:column>

                                            <p:column colspan="2" style="width:200px">
                                                <f:facet name="header">
                                                    <h:outputText value="#{bankStatementSummary.lastThreeMonth3}"
                                                                  rendered="#{not empty bankStatementSummary.lastThreeMonth3}">
                                                        <f:convertDateTime pattern="MMM yyyy" locale="th_TH"/>
                                                    </h:outputText>
                                                </f:facet>
                                            </p:column>
                                            <p:column rowspan="2" headerText="#{msg.get('app.bankStmtSum.table.column.averageBaht')}" style="width:100px"/>
                                        </p:row>

                                        <p:row>
                                            <p:column headerText="#{msg.get('app.bankStmtSum.table.column.osBalanceEndDay')}"/>
                                            <p:column headerText="#{msg.get('app.bankStmtSum.table.column.amountBaht')}"/>

                                            <p:column headerText="#{msg.get('app.bankStmtSum.table.column.osBalanceEndDay')}"/>
                                            <p:column headerText="#{msg.get('app.bankStmtSum.table.column.amountBaht')}"/>

                                            <p:column headerText="#{msg.get('app.bankStmtSum.table.column.osBalanceEndDay')}"/>
                                            <p:column headerText="#{msg.get('app.bankStmtSum.table.column.amountBaht')}"/>
                                        </p:row>
                                    </p:columnGroup>

                                    <p:column styleClass="left top">
                                        <h:outputText value="#{item.accountName}"/>
                                    </p:column>

                                    <p:column styleClass="center top">
                                        <h:outputText value="#{item.accountNumber}"/>
                                    </p:column>

                                    <p:column styleClass="left top">
                                        <h:outputText value="#{item.bankAccountTypeView.name}"
                                                      rendered="#{not empty item.bankAccountTypeView}"/>
                                        <h:outputText value="#{bankStatementSummary.getOtherBankAccType(item.otherAccountType)}"
                                                      rendered="#{item.otherAccountType gt 0}"/>
                                    </p:column>

                                    <!-- Month (T-2) -->
                                    <p:column styleClass="center top">
                                        <h:outputText value="#{item.srcOfCollateralProofViewList[0].dateOfMaxBalance}"
                                                      rendered="#{not empty item.srcOfCollateralProofViewList and fn:length(item.srcOfCollateralProofViewList) gt 0 and not empty item.srcOfCollateralProofViewList[0].dateOfMaxBalance}">
                                            <f:convertDateTime pattern="dd/MM/yyyy" locale="th_TH"/>
                                        </h:outputText>
                                    </p:column>
                                    <p:column styleClass="right top">
                                        <h:outputText value="#{item.srcOfCollateralProofViewList[0].maxBalance}"
                                                      rendered="#{not empty item.srcOfCollateralProofViewList and fn:length(item.srcOfCollateralProofViewList) gt 0 and not empty item.srcOfCollateralProofViewList[0].maxBalance}">
                                            <f:convertNumber pattern="#,##0.##" minFractionDigits="2" maxFractionDigits="2" maxIntegerDigits="14"/>
                                        </h:outputText>
                                    </p:column>

                                    <!-- Month (T-1) -->
                                    <p:column styleClass="center top">
                                        <h:outputText value="#{item.srcOfCollateralProofViewList[1].dateOfMaxBalance}"
                                                      rendered="#{not empty item.srcOfCollateralProofViewList and fn:length(item.srcOfCollateralProofViewList) gt 1 and not empty item.srcOfCollateralProofViewList[1].dateOfMaxBalance}">
                                            <f:convertDateTime pattern="dd/MM/yyyy" locale="th_TH"/>
                                        </h:outputText>
                                    </p:column>
                                    <p:column styleClass="right top">
                                        <h:outputText value="#{item.srcOfCollateralProofViewList[1].maxBalance}"
                                                      rendered="#{not empty item.srcOfCollateralProofViewList and fn:length(item.srcOfCollateralProofViewList) gt 1 and not empty item.srcOfCollateralProofViewList[1].maxBalance}">
                                            <f:convertNumber pattern="#,##0.##" minFractionDigits="2" maxFractionDigits="2" maxIntegerDigits="14"/>
                                        </h:outputText>
                                    </p:column>

                                    <!-- Month (T) -->
                                    <p:column styleClass="center top">
                                        <h:outputText value="#{item.srcOfCollateralProofViewList[2].dateOfMaxBalance}"
                                                      rendered="#{not empty item.srcOfCollateralProofViewList and fn:length(item.srcOfCollateralProofViewList) gt 2 and not empty item.srcOfCollateralProofViewList[2].dateOfMaxBalance}">
                                            <f:convertDateTime pattern="dd/MM/yyyy" locale="th_TH"/>
                                        </h:outputText>
                                    </p:column>
                                    <p:column styleClass="right top">
                                        <h:outputText value="#{item.srcOfCollateralProofViewList[2].maxBalance}"
                                                      rendered="#{not empty item.srcOfCollateralProofViewList and fn:length(item.srcOfCollateralProofViewList) gt 2 and not empty item.srcOfCollateralProofViewList[2].maxBalance}">
                                            <f:convertNumber pattern="#,##0.##" minFractionDigits="2" maxFractionDigits="2" maxIntegerDigits="14"/>
                                        </h:outputText>
                                    </p:column>

                                    <p:column styleClass="right top">
                                        <h:outputText value="#{item.avgOSBalanceAmount}"
                                                      rendered="#{not empty item.avgOSBalanceAmount}">
                                            <f:convertNumber pattern="#,##0.##" minFractionDigits="2" maxFractionDigits="2" maxIntegerDigits="14"/>
                                        </h:outputText>
                                    </p:column>

                                    <p:columnGroup type="footer">
                                        <p:row>
                                            <p:column colspan="10" style="height: 28px;"/>
                                        </p:row>

                                        <p:row>
                                            <p:column colspan="9" footerText="#{msg.get('app.bankStmtSum.grandTotal')}"
                                                      style="background-color:#f4f8b6; text-align: left;"/>

                                            <p:column style="background-color:#f4f8b6; text-align: right;">
                                                <f:facet name="footer">
                                                    <h:outputText value="#{bankStatementSummary.summaryView.grdTotalAvgOSBalanceAmount}">
                                                        <f:convertNumber pattern="#,##0.##" minFractionDigits="2" maxFractionDigits="2" maxIntegerDigits="14"/>
                                                    </h:outputText>
                                                </f:facet>
                                            </p:column>
                                        </p:row>
                                    </p:columnGroup>

                                </p:dataTable>
                            </td>
                        </tr>

                        <tr>
                            <td colspan="2" style="height:28px;">
                                <!-- Hidden -->
                                <h:inputHidden value="#{bankStatementSummary.summaryView.grdTotalBorrowerIncomeGross}"/>
                                <h:inputHidden value="#{bankStatementSummary.summaryView.grdTotalBorrowerIncomeNetBDM}"/>
                                <h:inputHidden value="#{bankStatementSummary.summaryView.grdTotalBorrowerIncomeNetUW}"/>
                            </td>
                        </tr>

                        <tr>
                            <td colspan="2">
                                <div class="separate"><!-- --></div>
                            </td>
                        </tr>

                        <tr>
                            <td class="center" colspan="2">
                                <p:commandButton id="btnSave" value="#{msg.get('app.button.save')}"
                                                 binding="#{saveButton}"
                                                 actionListener="#{bankStatementSummary.onSaveSummary()}"
                                                 process="@form"
                                                 update=":frmMain,:msgBoxSystemMessagePanel"
                                                 styleClass="smaller"/>
                            </td>
                        </tr>
                    </table>
                    </div>
                </div>
            </div>

            <div class="clear"></div>

            <div id="bottom_line"></div>
            <!-- Start Footer -->
            <ui:include src="include/footer.xhtml"/>
            <!-- End Footer -->
            </div>

            <p:blockUI widgetVar="blockUI" block=":frmMain"
                       trigger=":frmMain:btnRefresh,:frmMain:btnAddTmbBank,:frmMain:btnAddOthBank,:frmMain:btnSave">
                LOADING<br/>
                <p:graphicImage value="/resources/images/shared/ajax-loader.gif"/>
            </p:blockUI>
        </h:form>
    </p:panel>

    <ui:include src="dialog/confirmChangeScreenDlg.xhtml">
        <ui:param name="id" value="confirmChangeScreenBankStmtDialog"/>
        <ui:param name="name" value="confirmChangeScreenBankStmtDlg"/>
        <ui:param name="headerMessage" value="#{bankStatementSummary.confirmMessageHeader}"/>
        <ui:param name="message" value="#{bankStatementSummary.confirmMessage}"/>
        <ui:param name="formId" value="frmConfirmChangeScreenBankStmt"/>
        <ui:param name="controller" value="#{bankStatementSummary}"/>
        <ui:param name="action" value="onRedirectToBankStmtDetail"/>
        <ui:param name="update" value=":frmMain"/>
        <ui:param name="width" value="450"/>
    </ui:include>

    <ui:include src="dialog/confirmDeleteDlg.xhtml">
        <ui:param name="id" value="confirmDeleteBankStmtDialog"/>
        <ui:param name="name" value="confirmDeleteBankStmtDlg"/>
        <ui:param name="formId" value="frmConfirmDeleteBankStmt"/>
        <ui:param name="controller" value="#{bankStatementSummary}"/>
        <ui:param name="action" value="onDeleteBankStmt"/>
        <ui:param name="update" value=":frmMain,:msgBoxSystemMessagePanel"/>
    </ui:include>

    <p:panel id="msgBoxSystemMessagePanel" styleClass="panel">
        <p:confirmDialog id="msgBoxSystemMessageDialog" widgetVar="msgBoxSystemMessageDlg"
                         severity="#{bankStatementSummary.severity}"
                         header="#{bankStatementSummary.messageHeader}" message="#{bankStatementSummary.message}">
            <p:commandButton value="OK"
                             process="@this"
                             update="frmMain"
                             oncomplete="msgBoxSystemMessageDlg.hide()"/>
        </p:confirmDialog>
    </p:panel>

</h:body>
</f:view>
</html>