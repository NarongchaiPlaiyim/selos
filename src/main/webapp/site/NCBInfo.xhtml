<!DOCTYPE html>
<html>
<f:view xmlns="http://www.w3.org/1999/xhtml"
        xmlns:f="http://java.sun.com/jsf/core"
        xmlns:h="http://java.sun.com/jsf/html"
        xmlns:ui="http://java.sun.com/jsf/facelets"
        xmlns:p="http://primefaces.org/ui">

<h:head>
    <title>SE-LOS : NCB Record Detail</title>
    <link type="text/css" rel="stylesheet" href="#{request.contextPath}/resources/css/style.css"/>
    <script type="text/javascript" language="javascript" src="#{request.contextPath}/resources/js/jquery.numeric.js"/>
    <script type="text/javascript" language="javascript" src="#{request.contextPath}/resources/js/custom.js"/>
</h:head>

<h:body>
<p:panel id="pnl_maincontainer">
<h:form id="frmMain">
<div id="main_container">
<!-- Start Header Logo -->
<ui:include src="include/header_logo.xhtml"/>
<!-- End Header Logo -->
<!-- Start Header Detail -->
<ui:include src="include/header_detail.xhtml"/>
<!-- End Header Detail -->
<!-- Start Menu -->
<ui:include src="include/menubar.xhtml"/>
<!-- End Menu -->
<div id="content_container">
<div id="content_name"><h:outputText value="#{msg.get('app.ncbRecordDetail')}"/></div>
<div id="content">
<div id="content_info">
    <div id="content_trackchange" title="Click to view Track Change">[ View Track Change ]
    </div>
    <div id="content_lastupdate">Last update by <h:outputText id="lastupdateName"
                                                              value="MR.BDM Maker"/>,
        <h:outputText id="lastupdateTime" value="18/08/2556 11:11:01"/></div>
</div>
<div id="content_form">
<!-- start content -->
<table class="content_table_form" >

<tr>
    <td style="width: 50px" class="title">
        <h:outputText value="#{msg.get('app.ncbSummaryResult')}"/>
    </td>
    <td style="width: 500px">
    </td>
</tr>
<tr>
    <td class="title">
        <h:outputText value="#{msg.get('app.ncbCheckingDate')}"/>
    </td>
    <td>
        <p:inputText value="#{ncbInfo.ncbInfoView.checkingDate}" id="checkingDate" disabled="true"/>
    </td>
</tr>

<tr>
    <td class="title">
        <h:outputText value="#{msg.get('app.noOfNCBCheckIn6months')}"/>
    </td>
    <td>
        <p:inputText value="#{ncbInfo.ncbInfoView.checkIn6Month}" disabled="true"/>
    </td>
</tr>
<tr>
    <td class="title">
        <h:outputText value="#{msg.get('app.paymentClass')}"/>
    </td>
    <td>
        <p:inputText value="#{ncbInfo.ncbInfoView.paymentClass}" disabled="true"/>
    </td>
</tr>
<tr>
    <td class="title">
        <h:outputText value="#{msg.get('app.typeOfCurrentPayment')}"/>
    </td>
    <td>
        <p:inputText value="#{ncbInfo.ncbInfoView.currentPaymentType}" disabled="true"/>
    </td>
</tr>
<tr>
    <td class="title">
        <h:outputText value="#{msg.get('app.typeOfHistoryPayment')}"/>
    </td>
    <td>
        <p:inputText value="#{ncbInfo.ncbInfoView.historyPaymentType}" disabled="true"/>
    </td>
</tr>
<tr>
    <td class="title">
        <h:outputText value="#{msg.get('app.NPLFlag')}"/>
    </td>
    <td>
        <h:form id="nplFlagForm">
            <table class="content_form">
                <tr>
                    <td class="title" style="width: 160px;">
                        <h:selectOneRadio id="NPLFlag" value="#{ncbInfo.ncbInfoView.nplFlag}">
                            <f:selectItem itemLabel="Yes" itemValue="1"/>
                            <f:selectItem itemLabel="No" itemValue="0"/>
                        </h:selectOneRadio>
                     </td>
                    <td class="title">
                        <h:selectBooleanCheckbox value="#{ncbInfo.ncbInfoView.nplTMBFlag}"/>
                        <h:outputText value="#{msg.get('app.isNPLwithTMB')}"></h:outputText>
                        <p:spacer width="5px;"/>
                        <h:selectOneMenu value="#{ncbInfo.ncbInfoView.nplTMBMonth}">
                            <f:selectItem itemLabel="January" itemValue="1"/>
                            <f:selectItem itemLabel="February" itemValue="2"/>
                        </h:selectOneMenu>
                        <p:spacer width="5px;"/>
                        <h:selectOneMenu value="#{ncbInfo.ncbInfoView.nplTMBYear}">
                            <f:selectItem itemLabel="2010" itemValue="2010"/>
                            <f:selectItem itemLabel="2011" itemValue="2011"/>
                            <f:selectItem itemLabel="2012" itemValue="2012"/>
                            <f:selectItem itemLabel="2013" itemValue="2013"/>
                        </h:selectOneMenu>
                        <p:spacer width="5px;"/>
                        <h:selectBooleanCheckbox value="#{ncbInfo.ncbInfoView.nplOtherFlag}"/><h:outputText
                            value="#{msg.get('app.isNPLwithOther')}"/>
                        <p:spacer width="5px;"/>
                        <h:selectOneMenu value="#{ncbInfo.ncbInfoView.nplOtherMonth}">
                            <f:selectItem itemLabel="January" itemValue="1"/>
                            <f:selectItem itemLabel="February" itemValue="2"/>
                        </h:selectOneMenu>
                        <p:spacer width="5px;"/>
                        <h:selectOneMenu value="#{ncbInfo.ncbInfoView.nplOtherYear}">
                            <f:selectItem itemLabel="2010" itemValue="2010"/>
                            <f:selectItem itemLabel="2011" itemValue="2011"/>
                            <f:selectItem itemLabel="2012" itemValue="2012"/>
                            <f:selectItem itemLabel="2013" itemValue="2013"/>
                        </h:selectOneMenu>
                    </td>
                </tr>
<!--                <tr>
                    <td colspan="2">
                        <h:inputHidden   value="#{ncbInfo.ncbInfoView.ncbCusMarriageStatus}" />
                        <h:inputHidden   value="#{ncbInfo.ncbInfoView.enquiry}" />
                        <h:inputHidden   value="#{ncbInfo.ncbInfoView.ncbLastInfoAsOfDate}" />
                        <h:inputHidden   value="#{ncbInfo.ncbInfoView.ncbCusName}" />
                        <h:inputHidden   value="#{ncbInfo.ncbInfoView.ncbCusAddress}" />
                    </td>
                </tr>-->
            </table>
        </h:form>
    </td>
</tr>
<tr>
    <td class="title">
        <h:outputText value="#{msg.get('app.TDRFlag')}"/>
    </td>
    <td>
        <h:form id="tdrFlagForm" >
            <table class="content_form">
                <tr>
                    <td class="title" style="width: 160px;">
                        <h:selectOneRadio id="tdrFlag" value="#{ncbInfo.ncbInfoView.tdrFlag}">
                            <f:selectItem itemLabel="Yes" itemValue="1"/>
                            <f:selectItem itemLabel="No" itemValue="0"/>
                        </h:selectOneRadio>
                    </td>
                    <td class="title">
                        <h:selectBooleanCheckbox value="#{ncbInfo.ncbInfoView.tdrTMBFlag}"/>
                        <h:outputText value="#{msg.get('app.isTDRwithTMB')}"></h:outputText>
                        <p:spacer width="5px;"/>
                        <h:selectOneMenu value="#{ncbInfo.ncbInfoView.tdrTMBMonth}">
                            <f:selectItem itemLabel="January" itemValue="1"/>
                            <f:selectItem itemLabel="February" itemValue="2"/>
                        </h:selectOneMenu>
                        <p:spacer width="5px;"/>
                        <h:selectOneMenu value="#{ncbInfo.ncbInfoView.tdrTMBYear}">
                            <f:selectItem itemLabel="2010" itemValue="2010"/>
                            <f:selectItem itemLabel="2011" itemValue="2011"/>
                            <f:selectItem itemLabel="2012" itemValue="2012"/>
                            <f:selectItem itemLabel="2013" itemValue="2013"/>
                        </h:selectOneMenu>
                        <p:spacer width="5px;"/>
                        <h:selectBooleanCheckbox value="#{ncbInfo.ncbInfoView.tdrOtherFlag}"/><h:outputText
                            value="#{msg.get('app.isTDRwithOther')}"/>
                        <p:spacer width="5px;"/>
                        <h:selectOneMenu value="#{ncbInfo.ncbInfoView.tdrOtherMonth}">
                            <f:selectItem itemLabel="January" itemValue="1"/>
                            <f:selectItem itemLabel="February" itemValue="2"/>
                        </h:selectOneMenu>
                        <p:spacer width="5px;"/>
                        <h:selectOneMenu value="#{ncbInfo.ncbInfoView.tdrOtherYear}">
                            <f:selectItem itemLabel="2010" itemValue="2010"/>
                            <f:selectItem itemLabel="2011" itemValue="2011"/>
                            <f:selectItem itemLabel="2012" itemValue="2012"/>
                            <f:selectItem itemLabel="2013" itemValue="2013"/>
                        </h:selectOneMenu>
                    </td>
                </tr>
            </table>
        </h:form>
    </td>
</tr>
<tr>
    <td class="title">
        <h:outputText value="#{msg.get('app.TDRPaymentCondition')}"/>
    </td>
    <td>
        <h:selectOneListbox id="dlgSattlementStatus" styleClass="largest" size="1"
                            value="#{ncbInfo.ncbDetailView.tdrCondition.id}" disabled="true">
            <f:selectItems value="#{ncbInfo.tdrConditionList}"
                           var="dlgTDRConditionList"
                           itemLabel="#{dlgTDRConditionList.description}"
                           itemValue="#{dlgTDRConditionList.id}"/>

        </h:selectOneListbox>
    </td>
</tr>
<tr>
    <td style="vertical-align: top" class="title">
        <h:outputText value="#{msg.get('app.remark')}"/>
    </td>
    <td>
        <p:inputTextarea cols="60" rows="3" name="remark" value="#{ncbInfo.ncbInfoView.remark}" disabled="true"/>
    </td>
</tr>
<tr>
    <td colspan="100%">
        <div class="separate"></div>
    </td>
</tr>
<tr>
    <td colspan="2">
        <p:commandButton
                id="btnAdd"
                value="#{msg.get('app.addButton')}"
                styleClass="smaller"
                process="@this"
                actionListener="#{ncbInfo.onAddNcbRecord}"
                update=":ncbDlgForm"
                oncomplete="ncbDlg.show();">
            <p:resetInput target=":ncbDlgForm"/>
        </p:commandButton>
    </td>
</tr>
<tr>
    <td colspan="2">
        <table>
            <tr>
                <td>

                    <p:dataTable id="resultNcbDetail" var="item" value="#{ncbInfo.ncbDetailViewList}"
                                 rowKey="#{item.ncbDetailView}" rowIndexVar="rowIndex" >
                        <p:columnGroup type="header">
                            <p:row>
                                <p:column>
                                    <f:facet style="width:20px" name="header">#{msg.get('app.ncbDetail.table.label.no')}</f:facet>
                                </p:column>
                                <p:column>
                                    <f:facet style="width:50px" name="header">#{msg.get('app.ncbDetail.table.label.loanAccountType')}</f:facet>
                                </p:column>
                                <p:column>
                                    <f:facet style="width:50px" name="header">#{msg.get('app.ncbDetail.table.label.isTMBAccount')}</f:facet>
                                </p:column>
                                <p:column>
                                    <f:facet style="width:60px" name="header">#{msg.get('app.ncbDetail.table.label.loanAccountStatus')}</f:facet>
                                </p:column>
                                <p:column>
                                    <f:facet style="width:90px" name="header">ข้อมูล ณ วันที<br/>(วัน/เดือน/ปี)</f:facet>
                                </p:column>
                                <p:column>
                                    <f:facet style="width:90px" name="header">วันที่เปิดบัญชี<br/>(วัน/เดือน/ปี)</f:facet>
                                </p:column>
                                <p:column>
                                    <f:facet style="width:120px" name="header">#{msg.get('app.ncbDetail.table.label.limit')}</f:facet>
                                </p:column>
                                <p:column>
                                    <f:facet style="width:120px" name="header">ภาระคงค้าง/ยอดใช้<br/>(หน่วย:บาท)</f:facet>
                                </p:column>
                                <p:column>
                                    <f:facet style="width:120px" name="header">ยอดชำระต่อเดือน<br/>(หน่วย:บาท)</f:facet>
                                </p:column>
                                <p:column>
                                    <f:facet style="width:60px" name="header">วันที่ปรับปรุงโครงสร้างหนี้<br/>(วัน/เดือน/ปี)</f:facet>
                                </p:column>
                                <p:column>
                                    <f:facet style="width:60px" name="header">ลักษณะการชำระหนี้ <br/>ณ ปัจจุบัน</f:facet>
                                </p:column>
                                <p:column>
                                    <f:facet style="width:60px" name="header">ลักษณะการชำระหนี้<br/>ที่ผ่านมา</f:facet>
                                </p:column>
                                <p:column>
                                    <f:facet style="width:50px" name="header">จำนวนการค้างชำระ<br/>ในรอบ 12 เดือน</f:facet>
                                </p:column>
                                <p:column>
                                    <f:facet style="width:50px" name="header">Over Limit<br/> (Times)</f:facet>
                                </p:column>
                                <p:column>
                                    <f:facet style="width:50px" name="header">Refinance/<br/>ชำระปิดบัญชี</f:facet>
                                </p:column>
                                <p:column>
                                    <f:facet style="width:30px" name="header">#{msg.get('app.ncbDetail.table.label.wcFlag')}</f:facet>
                                </p:column>
                                <p:column>
                                    <f:facet style="width:40px" name="header"></f:facet>
                                </p:column>

                            </p:row>
                        </p:columnGroup>
                         <p:subTable var="item1" value="#{ncbInfo.ncbDetailView}">
                            <f:facet name="header">
                            </f:facet>
                            <p:column styleClass="center">
                                <h:outputText value="#{rowIndex+1}"/>
                            </p:column>

                            <p:column styleClass="left">
                                <h:outputText value="#{item.accountType.name}"/>
                            </p:column>

                            <p:column  styleClass="center">
                                <h:outputText  value="#{item.TMB}"/>
                            </p:column>

                            <p:column styleClass="left">
                                <h:outputText value="#{item.accountStatus.name}"/>
                            </p:column>

                            <p:column styleClass="center">
                                <h:outputText value="#{item.dateOfInfo}" >
                                    <f:convertDateTime  pattern="dd/MM/yyyy"/>
                                </h:outputText>
                            </p:column>

                            <p:column styleClass="center">
                                <h:outputText value="#{item.accountOpenDate}" >
                                    <f:convertDateTime  pattern="dd/MM/yyyy"/>
                                </h:outputText>
                            </p:column>

                            <p:column styleClass="right">
                                <h:outputText value="#{item.limit}">
                                    <f:convertNumber pattern="#,##0" minFractionDigits="2" maxFractionDigits="2"/>
                                </h:outputText>
                            </p:column>

                            <p:column styleClass="right">
                                <h:outputText value="#{item.outstanding}">
                                    <f:convertNumber pattern="#,##0" minFractionDigits="2" maxFractionDigits="2"/>
                                </h:outputText>
                            </p:column>

                            <p:column styleClass="right">
                                <h:outputText value="#{item.installment}">
                                    <f:convertNumber pattern="#,##0" minFractionDigits="2" maxFractionDigits="2"/>
                                </h:outputText>
                            </p:column>

                            <p:column styleClass="center">
                                <h:outputText value="#{item.dateOfDebtRestructuring}">
                                    <f:convertDateTime  pattern="dd/MM/yyyy"/>
                                </h:outputText>
                            </p:column>

                            <p:column styleClass="left">
                                <h:outputText value="#{item.currentPayment.name}"/>
                            </p:column>

                            <p:column styleClass="left">
                                <h:outputText value="#{item.historyPayment.name}"/>
                            </p:column>

                            <p:column styleClass="left">
                                <h:outputText value="#{item.noOfOutstandingPaymentIn12months}"/>
                            </p:column>

                            <p:column styleClass="left">
                                <h:outputText value="#{item.noOfOverLimit}"/>
                            </p:column>

                            <p:column  styleClass="center">
                                <h:outputText  value="#{item.refinance}"/>
                            </p:column>

                            <p:column  styleClass="center">
                                <h:outputText   value="#{item.wc}"/>
                            </p:column>

                            <p:column>
                                <p:commandButton icon="ui-icon-pencil"
                                                 action="#{ncbInfo.onEditNcbDetail()}"
                                                 update=":ncbDlgForm"
                                                 oncomplete="ncbDlg.show();">
                                    <f:setPropertyActionListener value="#{item}"
                                                                 target="#{ncbInfo.selectNcbRecordItem}"/>
                                    <f:setPropertyActionListener value="#{rowIndex}"
                                                                 target="#{ncbInfo.rowIndex}"/>
                                </p:commandButton>
                                <p:commandButton title="Remove"
                                                 icon="ui-icon-trash"
                                                 oncomplete="confirmDeleteNcbRecordDlg.show()">
                                    <f:setPropertyActionListener value="#{item}"
                                                                 target="#{ncbInfo.selectNcbRecordItem}"/>
                                </p:commandButton>
                            </p:column>

                            <p:columnGroup type="footer" rendered="#{item.monthsPaymentFlag}">
                                <p:row>
                                    <p:column colspan="4" style="text-align: center"
                                              footerText="#{msg.get('app.ncbDetail.table.label.noOfmonthsPayment')}  #{item.noOfmonthsPayment}"/>
                                    <p:column colspan="13" style="text-align: left"
                                              footerText="#{item.moneyTotal}"></p:column>
                                </p:row>
                            </p:columnGroup>

                        </p:subTable>
                    </p:dataTable>
                </td>
            </tr>

        </table>
    </td>

</tr>
<tr>
    <td colspan="2" class="center">
        <p:commandButton id="btnSave"
                         value="#{msg.get('app.saveButton')}"
                         styleClass="medium"
                         process=":frmMain"
                         action="#{ncbInfo.onSaveNcb()}"
                         update=":msgBoxSystemMessagePanel" />

        <p:commandButton value="#{msg.get('app.cancelButton')}"
                         id="btnCancel"
                         styleClass="medium"
                         process=":frmMain"
                         action="#{ncbInfo.onCancelNcbInfo()}"
                         update=":frmMain" />
    </td>
</tr>
</table>
<!-- end content -->
</div>
</div>
<div id="bottom_line"><!-- --></div>
</div>
<div class="clear"></div>
<!-- Start Footer -->
<ui:include src="include/footer.xhtml"/>
<!-- End Footer -->
<h:inputHidden id="pagename" value="mnuprescreen"/>
<h:inputHidden id="subpagename" value="submnuprescreen"/>
</div>
</h:form>
</p:panel>

<p:dialog id="ncbDialog" header="NCB Record Information" widgetVar="ncbDlg"
          modal="true" width="540" height="550">
    <ui:include src="dialog/NCBDetailDialog.xhtml"/>
</p:dialog>

<ui:include src="dialog/confirmDeleteDlg.xhtml">
    <ui:param name="id" value="confirmDeleteNcbRecordDialog"/>
    <ui:param name="name" value="confirmDeleteNcbRecordDlg"/>
    <ui:param name="formId" value="frmConfirmDeleteNcbRecord"/>
    <ui:param name="controller" value="#{ncbInfo}"/>
    <ui:param name="action" value="onDeleteNcbDetail"/>
    <ui:param name="update" value=":frmMain"/>
</ui:include>


<p:blockUI block="pnl_maincontainer" trigger=":frmMain:btnSave,:frmMain:btnCancel">
    LOADING<br />
    <p:graphicImage value="/resources/images/shared/ajax-loader.gif"/>
</p:blockUI>

<p:panel id="msgBoxSystemMessagePanel" styleClass="panel">
    <p:confirmDialog id="msgBoxSystemMessageDialog" widgetVar="msgBoxSystemMessageDlg"
                     header="#{ncbInfo.messageHeader}" message="#{ncbInfo.message}" >
        <p:commandButton value="OK"
                         process="@this"
                         update="frmMain"
                         oncomplete="msgBoxSystemMessageDlg.hide()"/>
    </p:confirmDialog>
</p:panel>

</h:body>
</f:view>
</html>