<ui:composition
        xmlns="http://www.w3.org/1999/xhtml"
        xmlns:f="http://java.sun.com/jsf/core"
        xmlns:h="http://java.sun.com/jsf/html"
        xmlns:ui="http://java.sun.com/jsf/facelets"
        xmlns:p="http://primefaces.org/ui"
        xmlns:clv="http://clevel.com/ui">

    <p:panel id="existingCollateralBorrowerDlgPanel" styleClass="panel-dialog">
        <h:form id="existingCollateralBorrowerDlgForm">
            <table class="content_form">
                <tr>
                    <td class="title" style="width:145px;">#{msg.get('app.credit.facility.existing.tb.label.collateralType.potential')}</td>
                    <td>
                        <p:selectOneMenu id="potentialCollateral" value="#{creditFacExisting.existingCollateralDetailView.potentialCollateral.id}" required="#{not empty param[saveBorrowerCollateral.clientId]}"
                                         size="1" style="min-width: 200px; width: 200px; max-width: 200px;" >
                            <f:selectItem itemLabel="- Please Select -" itemValue=""/>
                            <f:selectItems value="#{creditFacExisting.potentialCollateralList}"
                                           var="potentialColl"
                                           itemLabel="#{potentialColl.name}"
                                           itemValue="#{potentialColl.id}"/>
                            <p:ajax event="change" update="@this"/>
                        </p:selectOneMenu>
                    </td>
                </tr>
                <tr>
                    <td class="title" style="width:145px;">#{msg.get('app.credit.facility.existing.tb.label.collateralType.collateralType')}</td>
                    <td>
                        <p:selectOneMenu id="collateralType" value="#{creditFacExisting.existingCollateralDetailView.collateralType.id}" required="#{not empty param[saveBorrowerCollateral.clientId]}"
                                         size="1" style="min-width: 200px; width: 200px; max-width: 200px;" >
                            <f:selectItem itemLabel="- Please Select -" itemValue=""/>
                            <f:selectItems value="#{creditFacExisting.collateralTypeList}"
                                           var="collateralType"
                                           itemLabel="#{collateralType.description}"
                                           itemValue="#{collateralType.id}"/>
                            <p:ajax event="change" update="@this"/>
                        </p:selectOneMenu>
                    </td>
                </tr>
                <tr>
                    <td class="title" style="width:145px;">#{msg.get('app.credit.facility.existing.tb.label.collateralType.owner')}</td>
                    <td>
                        <p:inputText  value="#{creditFacExisting.existingCollateralDetailView.owner}" />
                    </td>
                </tr>
                <tr>
                    <td class="title" style="width:145px;">#{msg.get('app.credit.facility.existing.tb.label.collateralType.relationship')}</td>
                    <td>
                        <p:selectOneMenu id="relation" value="#{creditFacExisting.existingCollateralDetailView.relation.id}" required="#{not empty param[saveBorrowerCollateral.clientId]}"
                                         size="1" style="min-width: 200px; width: 200px; max-width: 200px;" >
                            <f:selectItem itemLabel="- Please Select -" itemValue=""/>
                            <f:selectItems value="#{creditFacExisting.relationList}"
                                           var="relation"
                                           itemLabel="#{relation.description}"
                                           itemValue="#{relation.id}"/>
                            <p:ajax event="change" update="@this"/>
                        </p:selectOneMenu>
                    </td>
                </tr>
                <tr>
                    <td class="title" style="width:145px;">#{msg.get('app.credit.facility.existing.tb.label.collateralType.appraisalDate')}</td>
                    <td>
                        <clv:BECalendar value="#{creditFacExisting.existingCollateralDetailView.appraisalDate}"
                                        id="dateOfInfo"
                                        showOn="button"
                                        pattern="dd/MM/yyyy"
                                        yearRange="1950:2100"
                                        maxdate="#{creditFacExisting.currentDateDDMMYY}"
                                        mindate="01/01/1950"
                                        navigator="true"
                                        locale="th_TH"
                                        showButtonPanel="true">
                        </clv:BECalendar>
                    </td>
                </tr>

                <tr>
                    <td class="title" style="width:145px;">#{msg.get('app.credit.facility.existing.tb.label.collateralType.number')}</td>
                    <td>
                        <p:inputText  value="#{creditFacExisting.existingCollateralDetailView.collateralNumber}" />
                    </td>
                </tr>
                <tr>
                    <td class="title" style="width:145px;">#{msg.get('app.credit.facility.existing.tb.label.collateralType.address')}</td>
                    <td>
                        <p:inputText  value="#{creditFacExisting.existingCollateralDetailView.collateralLocation}" />
                    </td>
                </tr>
                <tr>
                    <td class="title" style="width:145px;">#{msg.get('app.credit.facility.existing.tb.label.collateralType.remark')}</td>
                    <td>
                        <p:inputText  value="#{creditFacExisting.existingCollateralDetailView.remark}" />
                    </td>
                </tr>
                <tr>
                    <td class="title" style="width:145px;">Credit Type :</td>
                    <td>
                        <p:dataTable id="resultCreditCollateralBorrower" var="creditTypeBorrower"
                                     value="#{creditFacExisting.existingCollateralDetailView.existingCreditTypeDetailViewList}"
                                     rowKey="#{creditTypeBorrower.no}" rowIndexVar="rowIndex" style="width: 100%">
                            <p:columnGroup type="header">
                                <p:row>
                                    <p:column style="width:50px;"/>
                                    <p:column style="width:150px;"
                                              headerText="Account Name"/>
                                    <p:column style="width:200px;"
                                              headerText="Product Program"/>
                                    <p:column style="width:200px;"
                                              headerText="Credit Facility"/>
                                    <p:column style="width:200px;"
                                              headerText="Limit"/>
                                </p:row>
                            </p:columnGroup>
                            <p:column styleClass="center">
                                <p:selectBooleanCheckbox value="#{creditTypeBorrower.noFlag}" />
                            </p:column>

                            <p:column styleClass="center">
                                <p:outputLabel value="#{creditTypeBorrower.accountName}"/><br/>
                                <p:outputLabel value="#{creditTypeBorrower.accountNumber}"/>  <p:outputLabel value="#{creditTypeBorrower.accountSuf}"/>
                            </p:column>

                            <p:column styleClass="center">
                                <p:outputLabel  value="#{creditTypeBorrower.productProgram}" />
                            </p:column>

                            <p:column styleClass="center">
                                <p:outputLabel  value="#{creditTypeBorrower.creditFacility}" />
                            </p:column>
                            <p:column styleClass="center">
                                <p:outputLabel  value="#{creditTypeBorrower.limit}">
                                    <f:convertNumber pattern="#,##0.##" minFractionDigits="2" maxFractionDigits="2"
                                                     maxIntegerDigits="19"/>
                                </p:outputLabel>
                            </p:column>
                        </p:dataTable>
                    </td>
                </tr>
                <tr>
                    <td class="title" style="width:145px;">ประเภท :</td>
                    <td>
                        <p:selectOneMenu id="mortgageType" value="#{creditFacExisting.existingCollateralDetailView.mortgageType.id}" required="#{not empty param[saveBorrowerCollateral.clientId]}"
                                         size="1" style="min-width: 200px; width: 200px; max-width: 200px;" >
                            <f:selectItem itemLabel="- Please Select -" itemValue=""/>
                            <f:selectItems value="#{creditFacExisting.mortgageTypeList}"
                                           var="mortgage"
                                           itemLabel="#{mortgage.mortgage}"
                                           itemValue="#{mortgage.id}"/>
                            <p:ajax event="change" update="@this"/>
                        </p:selectOneMenu>
                    </td>
                </tr>
                <tr>
                    <td class="title" style="width:145px;">ราคาประเมิน :</td>
                    <td>
                        <p:inputText id="appraisalValue"  value="#{creditFacExisting.existingCollateralDetailView.appraisalValue}" maxlength="16">
                            <f:convertNumber pattern="#,##0.##" minFractionDigits="2" maxFractionDigits="2"/>
                            <p:ajax event="blur" update=":existingCollateralBorrowerDlgForm:appraisalValue"/>
                        </p:inputText>
                    </td>
                </tr>
                <tr>
                    <td class="title" style="width:145px;">จำนอง :</td>
                    <td>
                        <p:inputText id="mortgageValue" value="#{creditFacExisting.existingCollateralDetailView.mortgageValue}" maxlength="16">
                            <f:convertNumber pattern="#,##0.##" minFractionDigits="2" maxFractionDigits="2"/>
                            <p:ajax event="blur" update=":existingCollateralBorrowerDlgForm:mortgageValue"/>
                        </p:inputText>
                    </td>
                </tr>
                <tr>
                    <td colspan="2" class="center">
                        <p:commandButton
                                id="saveBorrowerCollateral" disabled="#{not creditFacExisting.canSaveBorrowerCol}"
                                binding="#{saveBorrowerCollateral}"
                                value="#{msg.get('app.tcg.dlg.button.ok')}"
                                actionListener="#{creditFacExisting.onSaveExistingCollateral()}"
                                process="@form"
                                update=":existingCollateralBorrowerDlgForm,:frmMain"
                                oncomplete="handleExistingCollateralBorrowerRequest(xhr, status, args)" />

                        <p:commandButton
                                value="#{msg.get('app.tcg.dlg.button.cancel')}"
                                styleClass="small"
                                onclick="existingCollateralBorrowerDlg.hide()"
                                />
                    </td>
                </tr>
            </table>
        </h:form>
    </p:panel>

    <p:blockUI widgetVar="blockExistingCollateralBorrowerDlgPanel" block="existingCollateralBorrowerDlgPanel" trigger="existingCollateralBorrowerDlgForm:saveBorrowerCollateral">
        LOADING<br/>
        <p:graphicImage value="/resources/images/shared/ajax-loader.gif"/>
    </p:blockUI>

</ui:composition>