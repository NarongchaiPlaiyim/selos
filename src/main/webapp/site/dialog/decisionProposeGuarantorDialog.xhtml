<ui:composition
        xmlns="http://www.w3.org/1999/xhtml"
        xmlns:h="http://java.sun.com/jsf/html"
        xmlns:f="http://java.sun.com/jsf/core"
        xmlns:ui="http://java.sun.com/jsf/facelets"
        xmlns:p="http://primefaces.org/ui">

<p:panel id="guarantorDlgPanel" styleClass="panel-dialog">
    <h:form id="guarantorDlgForm">
        <table class="content_form content_table_form">
            <tr>
                <td class="title" style="width: 20%">
                    <p:outputLabel for="dlgGuarantorRadioApprove"
                                   value="#{msg.get('app.decision.header')}"/>
                </td>
                <td class="left" style="width: 80%">
                    <p:selectOneRadio id="dlgGuarantorRadioApprove"
                                      value="#{decision.selectedAppProposeGuarantor.uwDecision}"
                                      required="#{not empty param[saveGuarantorButton.clientId]}">
                        <f:selectItem itemLabel="#{msg.get('app.button.approve')}" itemValue="2"/>
                        <f:selectItem itemLabel="#{msg.get('app.button.notApprove')}" itemValue="1"/>
                    </p:selectOneRadio>
                </td>
            </tr>
            <tr>
                <td class="title">
                    <p:outputLabel for="dlgGuarantorName"
                                   value="#{msg.get('app.credit.facility.propose.label.guarantorDlg.guarantorName')}"/>
                </td>
                <td class="left">
                    <p:selectOneMenu id="dlgGuarantorName"
                                     value="#{decision.selectedAppProposeGuarantor.guarantorName.id}"
                                     style="width: 200px;"
                                     required="#{not empty param[saveGuarantorButton.clientId]}">
                        <f:selectItem itemLabel="#{msg.get('app.select.item0')}" itemValue=""/>
                        <f:selectItems value="#{decision.guarantorList}"
                                       var="guarantorList"
                                       itemLabel="#{guarantorList.firstNameTh} #{guarantorList.lastNameTh}"
                                       itemValue="#{guarantorList.id}"/>
                    </p:selectOneMenu>
                </td>
            </tr>
            <tr>
                <td class="title">
                    <p:outputLabel for="dlgTcgLgNo" value="#{msg.get('app.credit.facility.propose.label.guarantorDlg.TCGLGNo')}"/>
                </td>
                <td class="left">
                    <p:inputMask id="dlgTcgLgNo" value="#{decision.selectedAppProposeGuarantor.tcgLgNo}"
                                 mask="99-9999"/>
                </td>
            </tr>
            <tr>
                <td class="title" colspan="2">
                    <p:outputLabel for="dlgGuarantorCreditTypeTable"
                                   value="#{msg.get('app.credit.facility.propose.label.guarantorDlg.creditType')}"/>
                </td>
            </tr>
            <tr>
                <td class="left" colspan="2">
                    <p:dataTable id="dlgGuarantorCreditTypeTable"
                                 value="#{decision.guarantorCreditTypeList}"
                                 var="creditTypeItem"
                                 selection="#{decision.selectedGuarantorCrdTypeItems}"
                                 rowKey="#{creditTypeItem.seq}"
                                 rowIndexVar="rowIndex"
                                 style="width: 100%;">

                        <p:columnGroup type="header">
                            <p:row>
                                <p:column style="width: 5%" selectionMode="multiple"/>
                                <p:column style="width: 35%"
                                          headerText="#{msg.get('app.credit.facility.propose.label.collateral.account')}"/>
                                <p:column style="width: 10%"
                                          headerText="#{msg.get('app.credit.facility.propose.label.collateral.requestCreditType')}"/>
                                <p:column style="width: 10%"
                                          headerText="#{msg.get('app.credit.facility.propose.label.collateral.productProgram')}"/>
                                <p:column style="width: 10%"
                                          headerText="#{msg.get('app.credit.facility.propose.label.collateral.creditFacility')}"/>
                                <p:column style="width: 15%"
                                          headerText="#{msg.get('app.credit.facility.propose.label.collateral.limit')}"/>
                                <p:column style="width: 15%"
                                          headerText="#{msg.get('app.credit.facility.propose.label.guarantor.guaranteeAmount')}"/>
                            </p:row>

                        </p:columnGroup>

                        <p:column styleClass="center" selectionMode="multiple"/>

                        <p:column styleClass="left top">
                            #{creditTypeItem.accountName}<br/>
                            #{msg.get('app.decision.tb.td.label.accNo')} #{creditTypeItem.accountNumber},&#160;
                            #{msg.get('app.decision.tb.td.label.suf')} #{creditTypeItem.accountSuf}
                        </p:column>

                        <p:column styleClass="left top">
                            <h:outputText value="#{creditTypeItem.requestType == 2 ? msg.get('app.label.new') :
                                                   creditTypeItem.requestType == 1 ? msg.get('app.label.change') : ''}"/>
                        </p:column>

                        <p:column styleClass="left top">
                            #{not empty creditTypeItem.productProgramView ? creditTypeItem.productProgramView.name : ''}
                        </p:column>

                        <p:column styleClass="left top">
                            #{not empty creditTypeItem.creditFacilityView ? creditTypeItem.creditFacilityView.name : ''}
                        </p:column>

                        <p:column styleClass="right top">
                            <h:outputText value="#{creditTypeItem.limit}">
                                <f:convertNumber pattern="#,##0.##"
                                                 minFractionDigits="2" maxFractionDigits="2"
                                                 maxIntegerDigits="14"/>
                            </h:outputText>
                        </p:column>

                        <p:column styleClass="center top">
                            <p:inputText value="#{creditTypeItem.guaranteeAmount}"
                                         onclick="this.select()"
                                         onkeydown="return onKeyDownMoney(event);"
                                         onkeypress="return onKeyPressMoney(event);"
                                         styleClass="right">
                                <f:convertNumber pattern="#,##0.##"
                                                 minFractionDigits="2" maxFractionDigits="2"
                                                 maxIntegerDigits="14"/>
                                <p:ajax event="blur" update="@this"/>
                            </p:inputText>
                        </p:column>

                    </p:dataTable>
                </td>
            </tr>
            <tr>
                <td colspan="2" style="height:28px;"></td>
            </tr>
            <tr>
                <td class="center" colspan="2">
                    <p:commandButton
                            id="saveGuarantorDlg"
                            value="#{msg.get('app.credit.facility.propose.okButton')}"
                            binding="#{saveGuarantorButton}"
                            styleClass="small"
                            action="#{decision.onSaveGuarantorInfo()}"
                            process=":@form"
                            update=":guarantorDlgForm,:frmMain,:msgBoxSystemMessagePanel"
                            oncomplete="handleDialogRequest(xhr, status, args, 'proposeGuarantorDlg')"/>
                    <p:spacer width="10" height="0"/>
                    <p:commandButton
                            value="#{msg.get('app.credit.facility.propose.cancelButton')}"
                            styleClass="small"
                            onclick="proposeGuarantorDlg.hide()"/>
                </td>
            </tr>
            <tr>
                <td colspan="2" style="height:10px;"></td>
            </tr>
        </table>
    </h:form>
</p:panel>

<p:blockUI widgetVar="blockGuarantorDlg" block="guarantorDlgPanel"
           trigger=":guarantorDlgForm:saveGuarantorDlg">
    LOADING<br/>
    <p:graphicImage value="/resources/images/shared/ajax-loader.gif"/>
</p:blockUI>

</ui:composition>