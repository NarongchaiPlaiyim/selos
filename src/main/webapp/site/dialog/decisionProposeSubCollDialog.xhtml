<ui:composition
        xmlns="http://www.w3.org/1999/xhtml"
        xmlns:f="http://java.sun.com/jsf/core"
        xmlns:h="http://java.sun.com/jsf/html"
        xmlns:ui="http://java.sun.com/jsf/facelets"
        xmlns:p="http://primefaces.org/ui">

<p:panel id="subCollateralDlgPanel" styleClass="panel-dialog" style="font-size: 12px !important;">
    <h:form id="subCollateralDlgForm">
        <table class="content_form content_table_form">
            <tr>
                <td class="title" style="width: 35%">
                    <p:outputLabel for="dlgSubCollateralType"
                                   value="#{msg.get('app.credit.facility.propose.dlg.subcoll.subcollTypeCaption')}"/>
                </td>
                <td class="left" style="width: 65%">
                    <p:selectOneMenu id="dlgSubCollateralType"
                                     value="#{decision.selectedAppSubCollateral.subCollateralType.id}"
                                     required="#{not empty param[saveSubCollButton.clientId]}"
                                     style="min-width: 200px; width: 200px; max-width: 200px;">
                        <f:selectItem itemLabel="#{msg.get('app.select.item0')}" itemValue=""/>
                        <f:selectItems value="#{decision.subCollateralTypeList}"
                                       var="subCollateralTypeItem"
                                       itemLabel="#{subCollateralTypeItem.description}"
                                       itemValue="#{subCollateralTypeItem.id}"/>
                    </p:selectOneMenu>
                </td>
            </tr>
            <tr>
                <td class="title">
                    <p:outputLabel for="dlgSubCollTitleDeed"
                                   value="#{msg.get('app.credit.facility.propose.dlg.subcoll.titleDeed')}"/>
                </td>
                <td class="left">
                    <p:inputText id="dlgSubCollTitleDeed" value="#{decision.selectedAppSubCollateral.titleDeed}"
                                 required="#{not empty param[saveSubCollButton.clientId]}"/>
                </td>
            </tr>
            <tr>
                <td class="title">
                    <p:outputLabel for="dlgSubCollAddress"
                                   value="#{msg.get('app.credit.facility.propose.dlg.subcoll.address')}"/>
                </td>
                <td class="left">
                    <p:inputText id="dlgSubCollAddress" value="#{decision.selectedAppSubCollateral.address}"
                                 required="#{not empty param[saveSubCollButton.clientId]}"/>
                </td>
            </tr>
            <tr>
                <td class="title">
                    <p:outputLabel for="dlgSubCollLandOffice"
                                   value="#{msg.get('app.credit.facility.propose.dlg.subcoll.landOffice')}"/>
                </td>
                <td class="left">
                    <p:inputText id="dlgSubCollLandOffice" value="#{decision.selectedAppSubCollateral.landOffice}"
                                 required="#{not empty param[saveSubCollButton.clientId]}"/>
                </td>
            </tr>
            <tr>
                <td class="title">
                    <p:outputLabel for="dlgSubCollOwnerAAD"
                                   value="#{msg.get('app.credit.facility.propose.dlg.subcoll.collateralOwner.AAD')}"/>
                </td>
                <td class="left">
                    <p:inputText id="dlgSubCollOwnerAAD" value="#{decision.selectedAppSubCollateral.collateralOwnerAAD}"
                                 required="#{not empty param[saveSubCollButton.clientId]}"/>
                </td>
            </tr>
            <tr>
                <td class="title">
                    <p:outputLabel for="dlgSubCollOwnerUW"
                                   value="#{msg.get('app.credit.facility.propose.dlg.subcoll.collateralOwner.UW')}"/>
                </td>
                <td class="left">
                    <table border="0" style="width: 100%">
                        <tr>
                            <td>
                                <p:selectOneMenu id="dlgSubCollOwnerUW"
                                                 value="#{decision.selectedAppSubCollateral.collateralOwnerUW.id}"
                                                 style="min-width: 200px; width: 200px; max-width: 200px; margin-left: -2px;">
                                    <f:selectItem itemLabel="#{msg.get('app.select.item0')}" itemValue=""/>
                                    <f:selectItems value="#{decision.collateralOwnerUwAllList}"
                                                   var="collateralOwnerUWItem"
                                                   itemLabel="#{collateralOwnerUWItem.firstNameTh} #{collateralOwnerUWItem.lastNameTh}"
                                                   itemValue="#{collateralOwnerUWItem.id}"/>
                                </p:selectOneMenu>
                            </td>
                            <td>
                                <p:commandButton
                                        id="addCollOwnerUWButton"
                                        value="#{msg.get('app.credit.facility.propose.button.addConditionButton')}"
                                        styleClass="smaller"
                                        action="#{decision.onAddCollateralOwnerUW()}"
                                        process="@this"
                                        update=":subCollateralDlgForm">
                                </p:commandButton>
                            </td>
                        </tr>
                    </table>
                </td>
            </tr>
            <tr>
                <td class="title"></td>
                <td class="left">
                    <p:dataTable id="CollOwnerUWTb"
                                 value="#{decision.selectedAppSubCollateral.collateralOwnerUWList}"
                                 var="collateralOwnerUWItem"
                                 rowKey="#{collateralOwnerUWItem.id}"
                                 rowIndexVar="rowIndex"
                                 style="width: 100%;">

                        <p:columnGroup type="header">
                            <p:row>
                                <p:column style="width: 10%; padding: 4px 10px !important;"/>
                                <p:column style="width: 80%; padding: 4px 10px !important;"
                                          headerText="#{msg.get('app.credit.facility.propose.label.subcoll.collateralName')}"/>
                                <p:column style="width: 10%; padding: 4px 10px !important;"/>
                            </p:row>
                        </p:columnGroup>
            
                        <p:column styleClass="center">
                            #{rowIndex + 1}
                        </p:column>
            
                        <p:column styleClass="left">
                            #{collateralOwnerUWItem.firstNameTh} #{collateralOwnerUWItem.lastNameTh}
                        </p:column>
            
                        <p:column styleClass="center">
                            <p:commandButton title="#{msg.get('app.button.delete')}"
                                             icon="ui-icon-trash"
                                             process="@this"
                                             actionListener="#{decision.onDeleteCollateralOwnerUW(rowIndex)}"
                                             update=":subCollateralDlgForm">
                            </p:commandButton>
                        </p:column>
            
                    </p:dataTable>
                </td>
            </tr>
            <tr>
                <td class="title">
                    <p:outputLabel for="dlgSubCollMortgageType"
                                   value="#{msg.get('app.credit.facility.propose.dlg.subcoll.mortgageType')}"/>
                </td>
                <td class="left">
                    <table border="0" style="width: 100%">
                        <tr>
                            <td>
                                <p:selectOneMenu id="dlgSubCollMortgageType"
                                                 value="#{decision.selectedAppSubCollateral.mortgageType.id}"
                                                 style="min-width: 200px; width: 200px; max-width: 200px; margin-left: -2px;">
                                    <f:selectItem itemLabel="#{msg.get('app.select.item0')}" itemValue=""/>
                                    <f:selectItems value="#{decision.mortgageTypeList}"
                                                   var="mortgageTypeItem"
                                                   itemLabel="#{mortgageTypeItem.mortgage}"
                                                   itemValue="#{mortgageTypeItem.id}"/>
                                </p:selectOneMenu>
                            </td>
                            <td>
                                <p:commandButton
                                        id="addMortgageTypeButton"
                                        value="#{msg.get('app.credit.facility.propose.button.addConditionButton')}"
                                        styleClass="smaller"
                                        actionListener="#{decision.onAddMortgageType()}"
                                        process="@form"
                                        update=":subCollateralDlgForm">
                                </p:commandButton>
                            </td>
                        </tr>
                    </table>
                </td>
            </tr>
            <tr>
                <td class="title"></td>
                <td class="left">
                    <p:dataTable id="MortgageTb"
                                 value="#{decision.selectedAppSubCollateral.mortgageList}"
                                 var="mortgageItem"
                                 rowKey="#{mortgageItem.id}"
                                 rowIndexVar="rowIndex"
                                 style="width: 100%;">

                        <p:columnGroup type="header">
                            <p:row>
                                <p:column style="width: 10%; padding: 4px 10px !important;"/>
                                <p:column style="width: 80%; padding: 4px 10px !important;"
                                          headerText="#{msg.get('app.credit.facility.propose.label.subcoll.mortgageType')}"/>
                                <p:column style="width: 10%; padding: 4px 10px !important;"/>
                            </p:row>
                        </p:columnGroup>
            
                        <p:column styleClass="center">
                            #{rowIndex + 1}
                        </p:column>
            
                        <p:column styleClass="left">
                            #{mortgageItem.mortgage}
                        </p:column>
            
                        <p:column styleClass="center">
                            <p:commandButton title="#{msg.get('app.button.delete')}"
                                             icon="ui-icon-trash"
                                             process="@this"
                                             actionListener="#{decision.onDeleteMortgageType(rowIndex)}"
                                             update=":subCollateralDlgForm">
                            </p:commandButton>
                        </p:column>
            
                    </p:dataTable>
                </td>
            </tr>
            <tr>
                <td class="title">
                    <p:outputLabel for="dlgSubCollRelatedWith"
                                   value="#{msg.get('app.credit.facility.propose.dlg.subcoll.relatedWith')}"/>
                </td>
                <td class="left">
                    <table border="0" style="width: 100%">
                        <tr>
                            <td>
                                <p:selectOneMenu id="dlgSubCollRelatedWith"
                                                 value="#{decision.selectedAppSubCollateral.relatedWithId}"
                                                 style="min-width: 200px; width: 200px; max-width: 200px; margin-left: -2px;">
                                    <f:selectItem itemLabel="#{msg.get('app.select.item0')}" itemValue=""/>
                                    <f:selectItems value="#{decision.relatedWithAllList}"
                                                   var="relatedWithItem"
                                                   itemLabel="#{relatedWithItem.titleDeed}"
                                                   itemValue="#{relatedWithItem.id}"/>
                                </p:selectOneMenu>
                            </td>
                            <td>
                                <p:commandButton
                                        id="addRelatedWithButton"
                                        value="#{msg.get('app.credit.facility.propose.button.addConditionButton')}"
                                        styleClass="smaller"
                                        action="#{decision.onAddRelatedWith()}"
                                        process="@this"
                                        update=":subCollateralDlgForm">
                                </p:commandButton>
                            </td>
                        </tr>
                    </table>
                </td>
            </tr>
            <tr>
                <td class="title"></td>
                <td class="left">
                    <p:dataTable id="RelatedWithTb"
                                 value="#{decision.selectedAppSubCollateral.relatedWithList}"
                                 var="relatedWith"
                                 rowKey="#{relatedWith.id}"
                                 rowIndexVar="rowIndex"
                                 style="width: 100%;">

                        <p:columnGroup type="header">
                            <p:row>
                                <p:column style="width: 10%; padding: 4px 10px !important;"/>
                                <p:column style="width: 80%; padding: 4px 10px !important;"
                                          headerText="#{msg.get('app.credit.facility.propose.label.subcoll.relatedWith')}"/>
                                <p:column style="width: 10%; padding: 4px 10px !important;"/>
                            </p:row>
                        </p:columnGroup>
            
                        <p:column styleClass="center">
                            #{rowIndex + 1}
                        </p:column>
            
                        <p:column styleClass="center">
                            #{relatedWithItem.titleDeed}
                        </p:column>
            
                        <p:column styleClass="center">
                            <p:commandButton title="#{msg.get('app.button.delete')}"
                                             icon="ui-icon-trash"
                                             process="@this"
                                             actionListener="#{decision.onDeleteRelatedWith(rowIndex)}"
                                             update=":subCollateralDlgForm">
                            </p:commandButton>
                        </p:column>
            
                    </p:dataTable>
                </td>
            </tr>
            
            <tr>
                <td class="title">
                    <p:outputLabel for="dlgSubCollAppraisalVal"
                                   value="#{msg.get('app.credit.facility.propose.dlg.subcoll.appraisalValue')}"/>
                </td>
                <td class="left">
                    <p:inputText id="dlgSubCollAppraisalVal"
                                 value="#{decision.selectedAppSubCollateral.appraisalValue}"
                                 maxlength="18"
                                 onclick="this.select()"
                                 onkeydown="return onKeyDownNegMoney(event);"
                                 onkeypress="return onKeyPressNegMoney(event);"
                                 styleClass="right"
                                 required="#{not empty param[saveSubCollButton.clientId]}">
                        <f:convertNumber pattern="#,##0.##"
                                         minFractionDigits="2" maxFractionDigits="2"
                                         maxIntegerDigits="14"/>
                        <p:ajax event="blur" update="@this"/>
                    </p:inputText>
                </td>
            </tr>
            <tr>
                <td class="title">
                    <p:outputLabel for="dlgSubCollMortgageVal"
                                   value="#{msg.get('app.credit.facility.propose.dlg.subcoll.mortgageValue')}"/>
                </td>
                <td class="left">
                    <p:inputText id="dlgSubCollMortgageVal"
                                 value="#{decision.selectedAppSubCollateral.mortgageValue}"
                                 maxlength="18"
                                 onclick="this.select()"
                                 onkeydown="return onKeyDownNegMoney(event);"
                                 onkeypress="return onKeyPressNegMoney(event);"
                                 styleClass="right"
                                 required="#{not empty param[saveSubCollButton.clientId]}">
                        <f:convertNumber pattern="#,##0.##"
                                         minFractionDigits="2" maxFractionDigits="2"
                                         maxIntegerDigits="14"/>
                        <p:ajax event="blur" update="@this"/>
                    </p:inputText>
                </td>
            </tr>
            <tr>
                <td colspan="2" style="height:28px;"></td>
            </tr>
            <tr>
                <td class="center" colspan="2">
                    <p:commandButton
                            id="saveSubColl"
                            value="#{msg.get('app.button.ok')}"
                            styleClass="small"
                            binding="#{saveSubCollButton}"
                            actionListener="#{decision.onSaveSubCollateral()}"
                            process="@form"
                            update=":subCollateralDlgForm,:collateralDlgForm"
                            oncomplete="handleDialogRequest(xhr, status, args, 'subCollateralInfoDlg')"/>
                    <p:spacer width="10" height="0"/>
                    <p:commandButton
                            value="#{msg.get('app.credit.facility.propose.cancelButton')}"
                            styleClass="small"
                            onclick="subCollateralInfoDlg.hide()"/>
                </td>
            </tr>
            <tr>
                <td colspan="4" style="height:10px;"></td>
            </tr>
        </table>
    </h:form>
</p:panel>

<p:blockUI widgetVar="blockSubCollateralDlg" block="subCollateralDlgPanel"
           trigger=":subCollateralDlgForm:saveSubColl">
    LOADING<br/>
    <p:graphicImage value="/resources/images/shared/ajax-loader.gif"/>
</p:blockUI>

</ui:composition>