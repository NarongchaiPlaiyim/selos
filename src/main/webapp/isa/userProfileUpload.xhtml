<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html>
<html>
<f:view xmlns="http://www.w3.org/1999/xhtml"
        xmlns:f="http://java.sun.com/jsf/core"
        xmlns:h="http://java.sun.com/jsf/html"
        xmlns:p="http://primefaces.org/ui"
        xmlns:ui="http://java.sun.com/jsf/facelets">
    <h:head>
        <title>ManageUser</title>
        <h:outputStylesheet name="css/style.css" />
        <h:outputScript library="js" name="custom.js" />
    </h:head>
    <h:body>
        <p:panel id="pnl_maincontainer">
            <div id="main_container">
                <ui:include src="../site/include/header_logo.xhtml"/>
                <ui:include src="../site/include/menubar_isa.xhtml"/>
                <div id="content_container">
                    <h:form id="useruploadForm" >
                        <!-- L pane-->
                        <div class="body_lpane">
                            <label class="subject">Manage User</label>
                            <a class="step_border" href="manageUser.xhtml">User Profile</a>
                            <a class="step_border_select" href="userProfileUpload.xhtml">Upload User Profile</a>
                        </div>
                        <div class="body_rpane">
                            <label class="subject">Upload User Profile</label>
                            <table border="0">
                                <tr>
                                    <td style="width: 120px; min-width: 120px; max-width: 120px;" />
                                    <td style="width: 300px; min-width: 300px; max-width: 300px;" />
                                </tr>
                                <tr>
                                    <td class="title" >
                                        <p:outputLabel value="Export :"/>
                                    </td>
                                    <td>
                                        <p:commandButton value="Download"
                                                         styleClass="medium"
                                                         actionListener="#{isaUpload.onSubmitExportCSV()}"
                                                         update=":msgBoxSystemMessagePanel, @form"
                                                         allowTypes="/(\.|\/)(csv)$/"
                                                         ajax="false">
                                            <p:fileDownload value="#{isaUpload.streamedContent}" />
                                        </p:commandButton>

                                    </td>
                                </tr>
                                <tr/>
                                <tr/>
                                <tr/>
                                <tr/>
                                <tr/>
                                <tr/>
                                <tr/>
                                <tr/>
                                <tr/>
                                <tr/>
                                <tr/>
                                <tr>
                                    <td class="title" >
                                        <p:outputLabel value="Import :"/>
                                    </td>
                                    <td colspan="2">
                                        <p:fileUpload fileUploadListener="#{isaUpload.onSubmitImportCSV}"
                                                      allowTypes="/(\.|\/)(csv)$/"
                                                      sizeLimit="5000000"
                                                      required="true"
                                                      multiple="flase"
                                                      update=":msgBoxSystemMessagePanel, @form"
                                                      fileLimit="1"
                                                      auto="false"
                                                />
                                    </td>
                                </tr>
                            </table>
                            <table>
                                <ui:repeat value="#{isaUpload.downloadViewList}" var="downloadView" varStatus="rowDownloadIndex">
                                    <tr>
                                        <td style="width: 150px; min-width: 150px; max-width: 150px;" />
                                        <td style="width: 300px; min-width: 300px; max-width: 300px;" />
                                        <td style="width: 120px; min-width: 120px; max-width: 120px;" />

                                    </tr>
                                    <tr>
                                        <td class="title" >
                                            <p:outputLabel value="#{downloadView.date}">
                                                <f:convertDateTime pattern="dd-MM-yyyy HH:mm " />
                                            </p:outputLabel>
                                        </td>
                                        <td >
                                            <p:outputLabel value="#{downloadView.fileName}" />
                                        </td>
                                        <td class="title" >
                                            <p:commandButton value="Download" styleClass="medium"
                                                             update=":msgBoxSystemMessagePanel, @form"
                                                             ajax="false"
                                                             actionListener="#{isaUpload.onSubmitDownloadResultFile(downloadView.fullPath)}" >
                                                <p:fileDownload value="#{isaUpload.streamedContent}" />
                                            </p:commandButton>
                                        </td>
                                    </tr>
                                </ui:repeat>
                            </table>
                        </div>
                    </h:form>
                </div>
            </div>
        </p:panel>

        <p:panel id="msgBoxSystemMessagePanel" styleClass="panel">
            <p:confirmDialog id="msgBoxSystemMessageDialog" widgetVar="msgBoxSystemMessageDlg"
                             header="#{isaUpload.messageHeader}" message="#{isaUpload.message}" >
                <p:commandButton value="OK"
                                 process="@this"
                                 oncomplete="msgBoxSystemMessageDlg.hide()"/>
            </p:confirmDialog>
        </p:panel>

    </h:body>
</f:view>
</html>
